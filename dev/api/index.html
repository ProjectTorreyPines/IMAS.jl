<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · IMAS</title><meta name="title" content="API Reference · IMAS"/><meta property="og:title" content="API Reference · IMAS"/><meta property="twitter:title" content="API Reference · IMAS"/><meta name="description" content="Documentation for IMAS."/><meta property="og:description" content="Documentation for IMAS."/><meta property="twitter:description" content="Documentation for IMAS."/><script async src="https://www.googletagmanager.com/gtag/js?id=G-65D8V8C8VQ"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-65D8V8C8VQ', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">IMAS</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">IMAS.jl</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Benchmark"><span>Benchmark</span></a></li><li><a class="tocitem" href="#Control"><span>Control</span></a></li><li><a class="tocitem" href="#Extract"><span>Extract</span></a></li><li><a class="tocitem" href="#Functions-library"><span>Functions library</span></a></li><li><a class="tocitem" href="#Geometry"><span>Geometry</span></a></li><li><a class="tocitem" href="#Math"><span>Math</span></a></li><li><a class="tocitem" href="#Outlines"><span>Outlines</span></a></li><li><a class="tocitem" href="#Physics-boundary"><span>Physics boundary</span></a></li><li><a class="tocitem" href="#Physics-build"><span>Physics build</span></a></li><li><a class="tocitem" href="#Physics-collisions"><span>Physics collisions</span></a></li><li><a class="tocitem" href="#Physics-constants"><span>Physics constants</span></a></li><li><a class="tocitem" href="#Physics-currents"><span>Physics currents</span></a></li><li><a class="tocitem" href="#Physics-diagnostics"><span>Physics diagnostics</span></a></li><li><a class="tocitem" href="#Physics-equilibrium"><span>Physics equilibrium</span></a></li><li><a class="tocitem" href="#Physics-fast"><span>Physics fast</span></a></li><li><a class="tocitem" href="#Physics-fields"><span>Physics fields</span></a></li><li><a class="tocitem" href="#Physics-flux-surfaces"><span>Physics flux-surfaces</span></a></li><li><a class="tocitem" href="#Physics-interferometer"><span>Physics interferometer</span></a></li><li><a class="tocitem" href="#Physics-magnetics"><span>Physics magnetics</span></a></li><li><a class="tocitem" href="#Physics-neoclassical"><span>Physics neoclassical</span></a></li><li><a class="tocitem" href="#Physics-nuclear"><span>Physics nuclear</span></a></li><li><a class="tocitem" href="#Physics-particles"><span>Physics particles</span></a></li><li><a class="tocitem" href="#Physics-pedestal"><span>Physics pedestal</span></a></li><li><a class="tocitem" href="#Physics-pf_active"><span>Physics pf_active</span></a></li><li><a class="tocitem" href="#Physics-profiles"><span>Physics profiles</span></a></li><li><a class="tocitem" href="#Physics-radiation"><span>Physics radiation</span></a></li><li><a class="tocitem" href="#Physics-sol"><span>Physics sol</span></a></li><li><a class="tocitem" href="#Physics-sources"><span>Physics sources</span></a></li><li><a class="tocitem" href="#Physics-technology"><span>Physics technology</span></a></li><li><a class="tocitem" href="#Physics-tf"><span>Physics tf</span></a></li><li><a class="tocitem" href="#Physics-thermal-loads"><span>Physics thermal loads</span></a></li><li><a class="tocitem" href="#Physics-transport"><span>Physics transport</span></a></li><li><a class="tocitem" href="#Plot"><span>Plot</span></a></li><li><a class="tocitem" href="#Real"><span>Real</span></a></li><li><a class="tocitem" href="#Signal"><span>Signal</span></a></li><li><a class="tocitem" href="#get-from"><span>get from</span></a></li></ul></li><li><a class="tocitem" href="../expressions/">Expressions</a></li><li><a class="tocitem" href="../license/">License</a></li><li><a class="tocitem" href="../notice/">Notice</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ProjectTorreyPines/IMAS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/master/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><h2 id="Benchmark"><a class="docs-heading-anchor" href="#Benchmark">Benchmark</a><a id="Benchmark-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmark" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.Benchmark"><a class="docstring-binding" href="#IMAS.Benchmark"><code>IMAS.Benchmark</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Benchmark{T}</code></pre><p>Struct for benchmarking time-dependent dd data structures</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/benchmark.jl#L5-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.benchmark"><a class="docstring-binding" href="#IMAS.benchmark"><code>IMAS.benchmark</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">benchmark(dd_ben::IMAS.dd{T}, times::AbstractVector{Float64}) where {T&lt;:Real}</code></pre><p>Evaluate self-consistency of a given IDS (flux-matching errors, etc.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/benchmark.jl#L52-L56">source</a></section><section><div><pre><code class="language-julia hljs">benchmark(dd_ben::IMAS.dd{T}, dd_ref::IMAS.dd{T}, times::AbstractVector{Float64}; self_benchmark::Bool=true) where {T&lt;:Real}</code></pre><p>Benchmark two dd structures at specified times</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/benchmark.jl#L131-L135">source</a></section><section><div><pre><code class="language-julia hljs">benchmark(x::AbstractVector{T}, y::AbstractVector{T}, x_ref::AbstractVector{T}, y_ref::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>evaluate error between two 1D arrays</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/benchmark.jl#L191-L195">source</a></section></details></article><h2 id="Control"><a class="docs-heading-anchor" href="#Control">Control</a><a id="Control-1"></a><a class="docs-heading-anchor-permalink" href="#Control" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.controller"><a class="docstring-binding" href="#IMAS.controller"><code>IMAS.controller</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">controller(ct::IMAS.controllers, name::String)</code></pre><p>Pick a controller based on its name, returns <code>nothing</code> if not found</p><p>NOTE: for now only looks under <code>dd.controllers.linear_controller</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/control/control.jl#L7-L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMASdd.controllers__linear_controller"><a class="docstring-binding" href="#IMASdd.controllers__linear_controller"><code>IMASdd.controllers__linear_controller</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">(controller::controllers__linear_controller{T})(control_name::Any, control_algorithm::Val{:PID}, setpoint::T, value::T, time0::Float64) where {T&lt;:Real}</code></pre><p>Operates PID controllers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/control/control.jl#L44-L48">source</a></section></details></article><h2 id="Extract"><a class="docs-heading-anchor" href="#Extract">Extract</a><a id="Extract-1"></a><a class="docs-heading-anchor-permalink" href="#Extract" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.extract"><a class="docstring-binding" href="#IMAS.extract"><code>IMAS.extract</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">extract(dd::IMAS.dd, library::Symbol=:extract)</code></pre><p>library can be one of:</p><ul><li><code>:extract</code> =&gt; <code>ExtractFunctionsLibrary</code></li><li><code>:moopt</code> =&gt; <code>ConstraintFunctionsLibrary</code> + <code>ObjectiveFunctionsLibrary</code></li><li><code>:all</code> =&gt; <code>ExtractFunctionsLibrary</code> + <code>ConstraintFunctionsLibrary</code> + <code>ObjectiveFunctionsLibrary</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/extract.jl#L54-L62">source</a></section><section><div><pre><code class="language-julia hljs">extract(dd::IMAS.dd, xtract::AbstractDict{Symbol,&lt;:ExtractFunction})</code></pre><p>Extract data from <code>dd</code>. Each of the <code>ExtractFunction</code> should accept <code>dd</code> as input, like this:</p><pre><code class="language-julia hljs">xtract = IMAS.ExtractFunction[
    :κ =&gt; ExtractFunction(:equilibrium, :κ, &quot;-&quot;, dd -&gt; dd.equilibrium.time_slice[].boundary.elongation)
    :Te0 =&gt; ExtractFunction(:profiles, :Te0, &quot;keV&quot;, dd -&gt; dd.core_profiles.profiles_1d[].electrons.temperature[1] / 1E3)
]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/extract.jl#L85-L94">source</a></section><section><div><pre><code class="language-julia hljs">extract(dd::IMAS.dd, filename::AbstractString, args...; kw...)</code></pre><p>Like <code>extract(dd)</code> but saves the data to HDF5 file</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/extract.jl#L104-L108">source</a></section></details></article><h2 id="Functions-library"><a class="docs-heading-anchor" href="#Functions-library">Functions library</a><a id="Functions-library-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-library" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.ConstraintFunction"><a class="docstring-binding" href="#IMAS.ConstraintFunction"><code>IMAS.ConstraintFunction</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">name::Symbol
units::String
func::Function
operation::Function
limit::Float64
tolerance::Float64</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/constraints.jl#L3-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ConstraintFunctionsLibrary"><a class="docstring-binding" href="#IMAS.ConstraintFunctionsLibrary"><code>IMAS.ConstraintFunctionsLibrary</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">ConstraintFunctionsLibrary::OrderedCollections.OrderedDict{Symbol,ConstraintFunction}</code></pre><p>Collection of ConstraintFunction</p><ul><li><code>power_electric_net → == 0.0 ± 0.2 [%]</code></li><li><code>min_power_electric_net → &gt; 0.0 [%]</code></li><li><code>flattop_duration → == 0.0 ± 0.01 [%]</code></li><li><code>min_flattop_duration → &gt; 0.0 [%]</code></li><li><code>min_required_B0 → &gt; 0.0 [%]</code></li><li><code>zero_ohmic → == 0.0 ± 0.1 [MA]</code></li><li><code>max_ne_peaking → &lt; 0.0 [%]</code></li><li><code>min_lh_power_threshold_fraction → &gt; 1.0 [%]</code></li><li><code>max_ωpe_ωce → &lt; 1.0 [%]</code></li><li><code>max_qpol_omp → &lt; 0.0 [%]</code></li><li><code>max_tf_coil_j → &lt; 1.0 [%]</code></li><li><code>max_oh_coil_j → &lt; 1.0 [%]</code></li><li><code>max_pl_stress → &lt; 1.0 [%]</code></li><li><code>max_tf_coil_stress → &lt; 1.0 [%]</code></li><li><code>max_oh_coil_stress → &lt; 1.0 [%]</code></li><li><code>max_hds03 → &lt; 0.0 [%]</code></li><li><code>min_q95 → &gt; 0.0 [%]</code></li><li><code>min_qmin → &gt; 0.0 [%]</code></li><li><code>max_beta_normal → &lt; 0.0 []</code></li><li><code>max_Psol_R → &lt; 0.0 [%]</code></li><li><code>max_transport_error → &lt; 0.1 []</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/constraints.jl#L119-L124">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ObjectiveFunction"><a class="docstring-binding" href="#IMAS.ObjectiveFunction"><code>IMAS.ObjectiveFunction</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">name::Symbol
units::String
func::Function
target::Float64</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/objectives.jl#L1-L6">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ObjectiveFunctionsLibrary"><a class="docstring-binding" href="#IMAS.ObjectiveFunctionsLibrary"><code>IMAS.ObjectiveFunctionsLibrary</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">ObjectiveFunctionsLibrary::OrderedCollections.OrderedDict{Symbol,ObjectiveFunction}</code></pre><p>Collection of ObjectiveFunction</p><ul><li><code>min_levelized_CoE → -Inf [$/kWh]</code></li><li><code>min_log10_levelized_CoE → -Inf [log₁₀($/kW)]</code></li><li><code>min_capital_cost → -Inf [$B]</code></li><li><code>max_fusion → Inf [MW]</code></li><li><code>max_power_electric_net → Inf [MW]</code></li><li><code>req_power_electric_net → 0.0 [ΔMW]</code></li><li><code>max_flattop → Inf [hours]</code></li><li><code>max_q95 → Inf []</code></li><li><code>req_flattop → 0.0 [Δhours]</code></li><li><code>max_log10_flattop → Inf [log₁₀(hours)]</code></li><li><code>min_βn → -Inf []</code></li><li><code>min_R0 → -Inf [m]</code></li><li><code>max_zeff → Inf []</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/objectives.jl#L105-L110">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ExtractFunction"><a class="docstring-binding" href="#IMAS.ExtractFunction"><code>IMAS.ExtractFunction</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">group::Symbol
name::Symbol
units::String
func::Function
error::Union{Nothing,Exception}
value::Any</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/extract.jl#L7-L14">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ExtractFunctionsLibrary"><a class="docstring-binding" href="#IMAS.ExtractFunctionsLibrary"><code>IMAS.ExtractFunctionsLibrary</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">ExtractFunctionsLibrary::OrderedCollections.OrderedDict{Symbol,ExtractFunction}</code></pre><p>Collection of ExtractFunction</p><ul><li><code>geometry.R0 → [m]</code></li><li><code>geometry.a → [m]</code></li><li><code>geometry.1/ϵ → [-]</code></li><li><code>geometry.κ → [-]</code></li><li><code>geometry.δ → [-]</code></li><li><code>geometry.ζ → [-]</code></li><li><code>geometry.Volume → [m³]</code></li><li><code>geometry.Surface → [m²]</code></li><li><code>equilibrium.B0 → [T]</code></li><li><code>equilibrium.ip → [MA]</code></li><li><code>equilibrium.q95 → [-]</code></li><li><code>equilibrium.&lt;Bpol&gt; → [T]</code></li><li><code>equilibrium.βpol_MHD → [-]</code></li><li><code>equilibrium.βtor_MHD → [-]</code></li><li><code>equilibrium.βn_MHD → [-]</code></li><li><code>temperatures.Te0 → [keV]</code></li><li><code>temperatures.Ti0 → [keV]</code></li><li><code>temperatures.&lt;Te&gt; → [keV]</code></li><li><code>temperatures.&lt;Ti&gt; → [keV]</code></li><li><code>temperatures.Te0/&lt;Te&gt; → [-]</code></li><li><code>temperatures.Ti0/&lt;Ti&gt; → [-]</code></li><li><code>densities.ne0 → [m⁻³]</code></li><li><code>densities.ne_ped → [m⁻³]</code></li><li><code>densities.ne_line → [m⁻³]</code></li><li><code>densities.&lt;ne&gt; → [m⁻³]</code></li><li><code>densities.ne0/&lt;ne&gt; → [-]</code></li><li><code>densities.fGW → [-]</code></li><li><code>densities.zeff_ped → [-]</code></li><li><code>densities.&lt;zeff&gt; → [-]</code></li><li><code>densities.impurities → [-]</code></li><li><code>pressures.P0 → [MPa]</code></li><li><code>pressures.&lt;P&gt; → [MPa]</code></li><li><code>pressures.P0/&lt;P&gt; → [-]</code></li><li><code>pressures.βn → [-]</code></li><li><code>pressures.βn_th → [-]</code></li><li><code>transport.τe → [s]</code></li><li><code>transport.τe_exp → [s]</code></li><li><code>transport.H98y2 → [-]</code></li><li><code>transport.H98y2_exp → [-]</code></li><li><code>transport.Hds03 → [-]</code></li><li><code>transport.Hds03_exp → [-]</code></li><li><code>transport.τα_thermalization → [s]</code></li><li><code>transport.τα_slowing_down → [s]</code></li><li><code>sources.Pec → [MW]</code></li><li><code>sources.rho0_ec → [MW]</code></li><li><code>sources.Pnbi → [MW]</code></li><li><code>sources.Enbi1 → [MeV]</code></li><li><code>sources.Pic → [MW]</code></li><li><code>sources.Plh → [MW]</code></li><li><code>sources.Paux_tot → [MW]</code></li><li><code>sources.Pα → [MW]</code></li><li><code>sources.Pohm → [MW]</code></li><li><code>sources.Pheat → [MW]</code></li><li><code>sources.Prad_tot → [MW]</code></li><li><code>exhaust.Psol → [MW]</code></li><li><code>exhaust.PLH → [MW]</code></li><li><code>exhaust.Bpol_omp → [T]</code></li><li><code>exhaust.λq → [mm]</code></li><li><code>exhaust.qpol → [MW/m²]</code></li><li><code>exhaust.qpar → [MW/m²]</code></li><li><code>exhaust.P/R0 → [MW/m]</code></li><li><code>exhaust.PB/R0 → [MW T/m]</code></li><li><code>exhaust.PBp/R0 → [MW T/m]</code></li><li><code>exhaust.PBϵ/R0q95 → [MW T/m]</code></li><li><code>exhaust.neutrons_peak → [MW/m²]</code></li><li><code>currents.ip_bs_aux_ohm → [MA]</code></li><li><code>currents.ip_ni → [MA]</code></li><li><code>currents.ip_bs → [MA]</code></li><li><code>currents.ip_aux → [MA]</code></li><li><code>currents.ip_ohm → [MA]</code></li><li><code>currents.ejima → [-]</code></li><li><code>currents.flattop → [Hours]</code></li><li><code>bop.Pfusion → [MW]</code></li><li><code>bop.Qfusion → [-]</code></li><li><code>bop.thermal_cycle_type → [-]</code></li><li><code>bop.thermal_efficiency_plant → [%]</code></li><li><code>bop.thermal_efficiency_cycle → [%]</code></li><li><code>bop.power_electric_generated → [MW]</code></li><li><code>bop.Pelectric_net → [MW]</code></li><li><code>bop.Qplant → [-]</code></li><li><code>bop.TBR → [-]</code></li><li><code>build.PF_material → [-]</code></li><li><code>build.TF_material → [-]</code></li><li><code>build.OH_material → [-]</code></li><li><code>build.TF_max_b → [T]</code></li><li><code>build.OH_max_b → [T]</code></li><li><code>build.TF_j_margin → [-]</code></li><li><code>build.OH_j_margin → [-]</code></li><li><code>build.TF_stress_margin → [-]</code></li><li><code>build.OH_stress_margin → [-]</code></li><li><code>costing.capital_cost → [$B]</code></li><li><code>costing.levelized_CoE → [$/kWh]</code></li><li><code>costing.TF_of_total → [%]</code></li><li><code>costing.BOP_of_total → [%]</code></li><li><code>costing.blanket_of_total → [%]</code></li><li><code>costing.cryostat_of_total → [%]</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/extract/extract.jl#L389-L394">source</a></section></details></article><h2 id="Geometry"><a class="docs-heading-anchor" href="#Geometry">Geometry</a><a id="Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.centroid"><a class="docstring-binding" href="#IMAS.centroid"><code>IMAS.centroid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">centroid(x::AbstractVector{&lt;:T}, y::AbstractVector{&lt;:T}) where {T&lt;:Real}</code></pre><p>Calculate centroid of polygon</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L7-L11">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.perimeter"><a class="docstring-binding" href="#IMAS.perimeter"><code>IMAS.perimeter</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">perimeter(r::AbstractVector{T}, z::AbstractVector{T})::T where {T&lt;:Real}</code></pre><p>Calculate the perimeter of a polygon</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L29-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.area"><a class="docstring-binding" href="#IMAS.area"><code>IMAS.area</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">area(x::AbstractVector{&lt;:T}, y::AbstractVector{&lt;:T}) where {T&lt;:Real}</code></pre><p>Calculate area of polygon</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L57-L61">source</a></section><section><div><pre><code class="language-julia hljs">area(layer::IMAS.build__layer)</code></pre><p>Calculate cross-sectional area of a build layer</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L292-L296">source</a></section><section><div><pre><code class="language-julia hljs">area(coil::IMAS.pf_active__coil)</code></pre><p>Returns cross sectional area of PF coils</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pf_active.jl#L3-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.revolution_volume"><a class="docstring-binding" href="#IMAS.revolution_volume"><code>IMAS.revolution_volume</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">revolution_volume(x::AbstractVector{&lt;:T}, y::AbstractVector{&lt;:T}) where {T&lt;:Real}</code></pre><p>Calculate volume of polygon revolved around x=0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L73-L77">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.intersection_angles"><a class="docstring-binding" href="#IMAS.intersection_angles"><code>IMAS.intersection_angles</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">intersection_angles(
    path1_r::AbstractVector{T},
    path1_z::AbstractVector{T},
    path2_r::AbstractVector{T},
    path2_z::AbstractVector{T},
    intersection_indexes::Vector{StaticArrays.SVector{2,Int}};
    mod_pi::Bool=true
) where {T&lt;:Real}</code></pre><p>returns angles of intersections between two paths and intersection_indexes given by intersection() function</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L85-L96">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.intersection"><a class="docstring-binding" href="#IMAS.intersection"><code>IMAS.intersection</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">intersection(
    l1_x::AbstractVector{T},
    l1_y::AbstractVector{T},
    l2_x::AbstractVector{T},
    l2_y::AbstractVector{T}
) where {T&lt;:Real}</code></pre><p>Intersections between two 2D paths, returns list of (x,y) intersection indexes and crossing points</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L127-L136">source</a></section><section><div><pre><code class="language-julia hljs">intersection(
    l1_x::AbstractVector{T},
    l1_y::AbstractVector{T},
    l2_x::AbstractVector{T},
    l2_y::AbstractVector{T},
    tolerance::Float64) where {T&lt;:Real}</code></pre><p>Intersections between two 2D paths, returns list of (x,y) intersection indexes and crossing points</p><p>Endpoints crossings are checked with some tolerance</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L165-L176">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.intersection_split"><a class="docstring-binding" href="#IMAS.intersection_split"><code>IMAS.intersection_split</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">intersection_split(
    l1_x::AbstractVector{T},
    l1_y::AbstractVector{T},
    l2_x::AbstractVector{T},
    l2_y::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>Returns vector of segments of l1<em>x,l1</em>y split at the intersections with l2<em>x,l2</em>y</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L294-L302">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.point_to_line_distance"><a class="docstring-binding" href="#IMAS.point_to_line_distance"><code>IMAS.point_to_line_distance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">point_to_line_distance(x0::Real, y0::Real, x1::Real, y1::Real, x2::Real, y2::Real)</code></pre><p>Distance of point (x0,y0) from line defined by points (x1,y1) and (x2,y2)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L349-L353">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.closest_point_to_segment"><a class="docstring-binding" href="#IMAS.closest_point_to_segment"><code>IMAS.closest_point_to_segment</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">closest_point_to_segment(x0::Real, y0::Real, x1::Real, y1::Real, x2::Real, y2::Real)</code></pre><p>Closest point on segment defined by points (x1,y1) and (x2,y2) to point (x0,y0)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L361-L365">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.point_to_segment_distance"><a class="docstring-binding" href="#IMAS.point_to_segment_distance"><code>IMAS.point_to_segment_distance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">point_to_segment_distance(x0::Real, y0::Real, x1::Real, y1::Real, x2::Real, y2::Real)</code></pre><p>Distance of point (x0,y0) from segment defined by points (x1,y1) and (x2,y2)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L391-L395">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.point_to_path_distance"><a class="docstring-binding" href="#IMAS.point_to_path_distance"><code>IMAS.point_to_path_distance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">point_to_path_distance(x0::Real, y0::Real, x::AbstractVector{&lt;:Real}, y::AbstractVector{&lt;:Real})</code></pre><p>Distance of point (x0,y0) from path defined by vectors x and y</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L408-L412">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.rdp_simplify_2d_path"><a class="docstring-binding" href="#IMAS.rdp_simplify_2d_path"><code>IMAS.rdp_simplify_2d_path</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rdp_simplify_2d_path(x::AbstractArray{T}, y::AbstractArray{T}, epsilon::T) where {T&lt;:Real}</code></pre><p>Simplifies a 2D line represented by arrays of x and y coordinates using the Ramer-Douglas-Peucker algorithm. The <code>epsilon</code> parameter controls the maximum distance allowed between a point on the original line and its simplified representation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L432-L438">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.rwa_simplify_2d_path"><a class="docstring-binding" href="#IMAS.rwa_simplify_2d_path"><code>IMAS.rwa_simplify_2d_path</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rwa_simplify_2d_path(x::AbstractArray{T}, y::AbstractArray{T}, epsilon::T) where {T&lt;:Real}</code></pre><p>Simplifies a 2D line represented by arrays of x and y coordinates using the Reumann-Witkam Algorithm algorithm. This algorithm uses a threshold value to determine which points to keep in the path. Points are kept if the angle between the previous and next line segments is greater than the threshold, and removed if it is less than or equal to the threshold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L490-L497">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.calculate_angle"><a class="docstring-binding" href="#IMAS.calculate_angle"><code>IMAS.calculate_angle</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calculate_angle(p1::T, p2::T, p3::T) where {T}</code></pre><p>Calculate the angle between three points</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L519-L523">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.simplify_2d_path"><a class="docstring-binding" href="#IMAS.simplify_2d_path"><code>IMAS.simplify_2d_path</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">simplify_2d_path(x::AbstractArray{T}, y::AbstractArray{T}, simplification_factor::T; model::Symbol=:distance)</code></pre><p>Simplify 2D path by <code>:curvature</code> (Reumann-Witkam Algorithm) or <code>:distance</code> (Ramer-Douglas-Peucker) algorithms</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L535-L539">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.resample_2d_path"><a class="docstring-binding" href="#IMAS.resample_2d_path"><code>IMAS.resample_2d_path</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">resample_2d_path(
    x::AbstractVector{T},
    y::AbstractVector{T};
    step::Float64=0.0,
    n_points::Integer=0,
    curvature_weight::Float64=0.0,
    retain_extrema::Bool=false,
    retain_original_xy::Bool=false,
    method::Symbol=:cubic) where {T&lt;:Real}</code></pre><p>Resample 2D line with uniform stepping (or number of points) with option to add more points where curvature is highest and option to retain extrema in x and y (in these cases stepping is not constant anymore!)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L553-L567">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.resample_plasma_boundary"><a class="docstring-binding" href="#IMAS.resample_plasma_boundary"><code>IMAS.resample_plasma_boundary</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">resample_plasma_boundary(
    x::AbstractVector{T},
    y::AbstractVector{T};
    step::Float64=0.0,
    n_points::Integer=0,
    curvature_weight::Float64=0.0,
    retain_extrema::Bool=true,
    retain_original_xy::Bool=false,
    method::Symbol=:linear) where {T&lt;:Real}</code></pre><p>Like resample<em>2d</em>path but with <code>retain_extrema=true</code> and <code>method=:linear</code> as defaults</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L635-L647">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.is_z_offset"><a class="docstring-binding" href="#IMAS.is_z_offset"><code>IMAS.is_z_offset</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_z_offset(pr::Vector{T}, pz::Vector{T}; order::Int=4, precision::Float64=1E-3) where {T&lt;:Real}</code></pre><p>Returns true the shape is offset from z=0 (ie. does not have mxh.z0=0)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L664-L668">source</a></section><section><div><pre><code class="language-julia hljs">is_z_offset(mxh::MXH; precision::Float64=1E-3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L679-L681">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.is_updown_symmetric"><a class="docstring-binding" href="#IMAS.is_updown_symmetric"><code>IMAS.is_updown_symmetric</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_updown_symmetric(pr::Vector{T}, pz::Vector{T}; order::Int=4, precision::Float64=1E-3) where {T&lt;:Real}</code></pre><p>Returns true if boundary is updown symmetric (independent of mxh.z0)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L689-L693">source</a></section><section><div><pre><code class="language-julia hljs">is_updown_symmetric(mxh::MXH; precision::Float64=1E-3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L701-L703">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.minimum_distance_polygons_vertices"><a class="docstring-binding" href="#IMAS.minimum_distance_polygons_vertices"><code>IMAS.minimum_distance_polygons_vertices</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">minimum_distance_polygons_vertices(
    R_obj1::AbstractVector{&lt;:T},
    Z_obj1::AbstractVector{&lt;:T},
    R_obj2::AbstractVector{&lt;:T},
    Z_obj2::AbstractVector{&lt;:T};
    return_index::Bool=false) where {T&lt;:Real}</code></pre><p>Returns minimum distance between two polygons vertices and index of points on the two polygons</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L711-L720">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.minimum_distance_polygons"><a class="docstring-binding" href="#IMAS.minimum_distance_polygons"><code>IMAS.minimum_distance_polygons</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">minimum_distance_polygons(
    R_obj1::AbstractVector{&lt;:T},
    Z_obj1::AbstractVector{&lt;:T},
    R_obj2::AbstractVector{&lt;:T},
    Z_obj2::AbstractVector{&lt;:T}) where {T&lt;:Real}</code></pre><p>Returns minimum distance between two polygons</p><p>NOTE: this is the actual distance, not the distance between the vertices</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L746-L756">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.min_mean_distance_polygons"><a class="docstring-binding" href="#IMAS.min_mean_distance_polygons"><code>IMAS.min_mean_distance_polygons</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">min_mean_distance_polygons(
    R_obj1::AbstractVector{&lt;:T},
    Z_obj1::AbstractVector{&lt;:T},
    R_obj2::AbstractVector{&lt;:T},
    Z_obj2::AbstractVector{&lt;:T}) where {T&lt;:Real}</code></pre><p>Calculate the minimum and mean distances between two polygons in 2D space.</p><p>NOTE: this is the actual distance, not the distance between the vertices</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L777-L787">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.curvature"><a class="docstring-binding" href="#IMAS.curvature"><code>IMAS.curvature</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">curvature(pr::AbstractVector{T}, pz::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>Calculate the curvature of a 2D path defined by <code>pr</code> and <code>pz</code> using a finite difference approximation.</p><p>The path is assumed to be closed if the first and last points are the same, and open otherwise.</p><p><strong>Arguments</strong></p><ul><li><code>pr</code>: Real abstract vector representing the r-coordinates of the path.</li><li><code>pz</code>: Real abstract vector representing the z-coordinates of the path.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of the same length as <code>pr</code> and <code>pz</code> with the calculated curvature values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L815-L830">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.angle_between_two_vectors"><a class="docstring-binding" href="#IMAS.angle_between_two_vectors"><code>IMAS.angle_between_two_vectors</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">angle_between_two_vectors(
    v1_p1::Tuple{T,T},
    v1_p2::Tuple{T,T},
    v2_p1::Tuple{T,T},
    v2_p2::Tuple{T,T}) where {T&lt;:Real}</code></pre><p>Returns angle in radiants between two vectors defined by their start and end points</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L863-L871">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.bisector"><a class="docstring-binding" href="#IMAS.bisector"><code>IMAS.bisector</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">bisector(v1, v2, v3)</code></pre><p>Returns signed unitary bisector given three vertices</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L891-L895">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.polygon_rays"><a class="docstring-binding" href="#IMAS.polygon_rays"><code>IMAS.polygon_rays</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">polygon_rays(vertices::AbstractVector, extent_a::Float64, extent_b::Float64)</code></pre><p>Returns bisecting &quot;rays&quot; (lines) that radiate from vertices of a polygon</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L927-L931">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.split_long_segments"><a class="docstring-binding" href="#IMAS.split_long_segments"><code>IMAS.split_long_segments</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">split_long_segments(R::AbstractVector{T}, Z::AbstractVector{T}, max_length::Float64) where {T&lt;:Real}</code></pre><p>Split long segments of a polygon so that each resulting segment is always &lt;= max_length</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L957-L961">source</a></section><section><div><pre><code class="language-julia hljs">split_long_segments(R::AbstractVector{T}, Z::AbstractVector{T}, n_points::Int) where {T&lt;:Real}</code></pre><p>Split long segments of a polygon so that there are at least n_points in it</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L990-L994">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.thick_line_polygon"><a class="docstring-binding" href="#IMAS.thick_line_polygon"><code>IMAS.thick_line_polygon</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">thick_line_polygon(r1, z1, r2, z2, thickness1, thickness2)</code></pre><p>Generates a closed polygon from a thick line. Returns points of the quadrilateral polygon</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L1004-L1008">source</a></section><section><div><pre><code class="language-julia hljs">thick_line_polygon(pr::AbstractVector{Float64}, pz::AbstractVector{Float64}, thickness::AbstractVector{Float64})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L1020-L1022">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.convex_hull"><a class="docstring-binding" href="#IMAS.convex_hull"><code>IMAS.convex_hull</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">convex_hull(xy_points::AbstractVector; closed_polygon::Bool)</code></pre><p>Compute the convex hull of a set of 2D points, sorted in counter-clockwise order. The resulting convex hull forms a closed polygon by appending the first point at the end.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L1144-L1149">source</a></section><section><div><pre><code class="language-julia hljs">convex_hull(x::AbstractVector{T}, y::AbstractVector{T}; closed_polygon::Bool) where {T}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L1161-L1163">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.convex_hull_indices"><a class="docstring-binding" href="#IMAS.convex_hull_indices"><code>IMAS.convex_hull_indices</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">convex_hull_indices(xy_points::AbstractVector)</code></pre><p>Compute the indices of points that form the convex hull of a set of 2D points. Returns the indices in counter-clockwise order.</p><p>This is the internal function that works with indices only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/geometry.jl#L1090-L1097">source</a></section></details></article><h2 id="Math"><a class="docs-heading-anchor" href="#Math">Math</a><a id="Math-1"></a><a class="docs-heading-anchor-permalink" href="#Math" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.norm01"><a class="docstring-binding" href="#IMAS.norm01"><code>IMAS.norm01</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">norm01(x::T)::T where {T&lt;:AbstractVector{&lt;:Real}}</code></pre><p>Normalize a vector so that the first item in the array is 0 and the last one is 1 This is handy where psi<em>norm should be used (and IMAS does not define a psi</em>norm array)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L3-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.to_range"><a class="docstring-binding" href="#IMAS.to_range"><code>IMAS.to_range</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">to_range(vector::AbstractVector)</code></pre><p>Turn a vector into a range (if possible)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L16-L20">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.meshgrid"><a class="docstring-binding" href="#IMAS.meshgrid"><code>IMAS.meshgrid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">meshgrid(x::AbstractVector{T}, y::AbstractVector{T}) where {T}</code></pre><p>Return coordinate matrices from coordinate vectors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L34-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.calc_z"><a class="docstring-binding" href="#IMAS.calc_z"><code>IMAS.calc_z</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calc_z(x::AbstractVector{&lt;:Real}, f::AbstractVector{&lt;:Real}, method::Symbol)</code></pre><p>Returns the gradient scale lengths of vector f on x</p><p>The finite difference <code>method</code> of the gradient can be one of [:backward, :central, :forward, :second<em>order, :third</em>order]</p><p>NOTE: the inverse scale length is NEGATIVE for typical density/temperature profiles</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L46-L54">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.integ_z"><a class="docstring-binding" href="#IMAS.integ_z"><code>IMAS.integ_z</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">integ_z(rho::AbstractVector{&lt;:Real}, z_profile::AbstractVector{&lt;:Real}, bc::Real)</code></pre><p>Backward integration of inverse scale length vector with given edge boundary condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L63-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.pack_grid_gradients"><a class="docstring-binding" href="#IMAS.pack_grid_gradients"><code>IMAS.pack_grid_gradients</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pack_grid_gradients(x::AbstractVector{T}, y::AbstractVector{T}; n_points::Int=length(x), l::Float64=1E-2) where {T&lt;:Float64}</code></pre><p>Returns grid between <code>minimum(x)</code> and <code>maximum(x)</code> with <code>n_points</code> points positioned to sample <code>y(x)</code> in such a way to pack more points where gradients are greates.</p><p><code>l</code> controls how much the adaptive gradiant sampling should approach linear sampling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L90-L97">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.unique_indices"><a class="docstring-binding" href="#IMAS.unique_indices"><code>IMAS.unique_indices</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">unique_indices(vec::AbstractVector)::Vector{Int}</code></pre><p>Return the indices of the first occurrence of each unique element in the input vector <code>vec</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L111-L115">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.index_circular"><a class="docstring-binding" href="#IMAS.index_circular"><code>IMAS.index_circular</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">index_circular(N::Int, idx::Int)</code></pre><p>If <code>idx</code> is beyond N or less than 1, it wraps around in a circular manner.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L124-L128">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.getindex_circular"><a class="docstring-binding" href="#IMAS.getindex_circular"><code>IMAS.getindex_circular</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">getindex_circular(vec::AbstractVector{T}, idx::Int)::T where {T}</code></pre><p>Return the element of the vector <code>vec</code> at the position <code>idx</code>.</p><p>If <code>idx</code> is beyond the length of <code>vec</code> or less than 1, it wraps around in a circular manner.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L136-L142">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.chunk_indices"><a class="docstring-binding" href="#IMAS.chunk_indices"><code>IMAS.chunk_indices</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">chunk_indices(dims::Tuple{Vararg{Int}}, N::Int)</code></pre><p>Split the indices of an array with dimensions <code>dims</code> into <code>N</code> chunks of similar size. Each chunk is a generator of <code>CartesianIndex</code> objects.</p><p><strong>Arguments</strong></p><ul><li><code>dims::Tuple{Vararg{Int}}</code>: A tuple specifying the dimensions of the array. For a 2D array, this would be <code>(rows, cols)</code>.</li><li><code>N::Int</code>: The number of chunks to split the indices into.</li></ul><p><strong>Returns</strong></p><ul><li>Vector with chunks of cartesian indices. Each chunk can be iterated over to get the individual <code>CartesianIndex</code> objects.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/math.jl#L151-L165">source</a></section></details></article><h2 id="Outlines"><a class="docs-heading-anchor" href="#Outlines">Outlines</a><a id="Outlines-1"></a><a class="docs-heading-anchor-permalink" href="#Outlines" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.OutlineClosedVector"><a class="docstring-binding" href="#IMAS.OutlineClosedVector"><code>IMAS.OutlineClosedVector</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">OutlineClosedVector{T,A&lt;:AbstractVector{T}} &lt;: AbstractVector{T}</code></pre><p>Outlines in IMAS v3 ontology are always open (NOTE: in v4 they will always be closed!)</p><p>Use OutlineClosedVector to have a vector that behaves like a it&#39;s a closed outline, without creating a new array (allocation free)</p><p>When OutlineClosedVector is put into the <code>dd</code>, it will automatically save it there as an open outline</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L3-L11">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.OutlineOpenVector"><a class="docstring-binding" href="#IMAS.OutlineOpenVector"><code>IMAS.OutlineOpenVector</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">OutlineOpenVector{T,A&lt;:AbstractVector{T}} &lt;: AbstractVector{T}</code></pre><p>Outlines in IMAS v3 ontology are always open (NOTE: in v4 they will always be closed!)</p><p>Use OutlineOpenVector to have a vector that behaves like a it&#39;s a open outline, without creating a new array (allocation free)</p><p>When OutlineOpenVector is put into the dd, it will automatically save it there as an open outline</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L82-L90">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.CircularVector"><a class="docstring-binding" href="#IMAS.CircularVector"><code>IMAS.CircularVector</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CircularVector{T,A&lt;:AbstractVector{T}} &lt;: AbstractVector{T}</code></pre><p>Vector with circular indexes, without creating a new array (allocation free)</p><p>NOTE: It can be combined with <code>OutlineClosedVector</code> and/or <code>OutlineOpenVector</code>, like this: <code>CircularVector(OutlineClosedVector(x, x_is_closed))</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L138-L144">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.is_open_polygon"><a class="docstring-binding" href="#IMAS.is_open_polygon"><code>IMAS.is_open_polygon</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_open_polygon(R::AbstractVector{T}, Z::AbstractVector{T})::Bool where {T&lt;:Real}</code></pre><p>Determine if a polygon, defined by separate vectors for R and Z coordinates, is open.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L184-L188">source</a></section><section><div><pre><code class="language-julia hljs">is_open_polygon(vertices::AbstractVector)::Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L193-L195">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.is_closed_polygon"><a class="docstring-binding" href="#IMAS.is_closed_polygon"><code>IMAS.is_closed_polygon</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_closed_polygon(R::AbstractVector{T}, Z::AbstractVector{T})::Bool where {T&lt;:Real}</code></pre><p>Determine if a polygon, defined by separate vectors for R and Z coordinates, is closed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L207-L211">source</a></section><section><div><pre><code class="language-julia hljs">is_closed_polygon(vertices::AbstractVector)::Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L216-L218">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.open_polygon"><a class="docstring-binding" href="#IMAS.open_polygon"><code>IMAS.open_polygon</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">open_polygon(R::AbstractVector{T}, Z::AbstractVector{T}, args...) where {T&lt;:Real}</code></pre><p>Returns a view of the vectors R and Z such that they are a open polygon</p><p>Returns a named tuple containing the status of the polygon (was<em>closed, was</em>open) and the views of the R and Z vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L226-L232">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.closed_polygon"><a class="docstring-binding" href="#IMAS.closed_polygon"><code>IMAS.closed_polygon</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">closed_polygon(R::AbstractVector{T}, Z::AbstractVector{T}, args...) where {T&lt;:Real}</code></pre><p>Returns a view of the vectors R and Z such that they are a closed polygon</p><p>Returns a named tuple containing the status of the polygon (was<em>closed, was</em>open) and the views of the R and Z vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L244-L250">source</a></section><section><div><pre><code class="language-julia hljs">closed_polygon(R::AbstractVector{T}, Z::AbstractVector{T}, closed::Bool, args...) where {T&lt;:Real}</code></pre><p>Returns a closed polygon depending on <code>closed</code> otherwise returns an open polygon</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L259-L263">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.is_clockwise"><a class="docstring-binding" href="#IMAS.is_clockwise"><code>IMAS.is_clockwise</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_clockwise(r::AbstractVector{T}, z::AbstractVector{T})::Bool where {T&lt;:Real}</code></pre><p>Returns true/false if polygon is defined clockwise</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L282-L286">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.is_counterclockwise"><a class="docstring-binding" href="#IMAS.is_counterclockwise"><code>IMAS.is_counterclockwise</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_counterclockwise(r::AbstractVector{T}, z::AbstractVector{T})::Bool where {T&lt;:Real}</code></pre><p>Returns true/false if polygon is defined counterclockwise</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/outline.jl#L307-L311">source</a></section></details></article><h2 id="Physics-boundary"><a class="docs-heading-anchor" href="#Physics-boundary">Physics boundary</a><a id="Physics-boundary-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-boundary" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.boundary_shape"><a class="docstring-binding" href="#IMAS.boundary_shape"><code>IMAS.boundary_shape</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">boundary_shape(;
    a::T,
    eps::T,
    kapu::T,
    kapl::T,
    delu::T,
    dell::T,
    zetaou::T,
    zetaiu::T,
    zetail::T,
    zetaol::T,
    zoffset::T,
    upnull::Bool=false,
    lonull::Bool=false,
    npts::Int=90
) where {T&lt;:Real}</code></pre><p>Function used to generate boundary shapes based on <code>T. C. Luce, PPCF, 55 9 (2013)</code></p><ul><li><code>a</code>: minor radius</li><li><code>eps</code>: aspect ratio</li><li><code>kapu</code>: upper elongation</li><li><code>lkap</code>: lower elongation</li><li><code>delu</code>: upper triangularity</li><li><code>dell</code>: lower triangularity</li><li><code>zetaou</code>: upper outer squareness</li><li><code>zetaiu</code>: upper inner squareness</li><li><code>zetail</code>: lower inner squareness</li><li><code>zetaol</code>: lower outer squareness</li><li><code>zoffset</code>: z-offset</li><li><code>upnull</code>: toggle upper x-point</li><li><code>lonull</code>: toggle lower x-point</li><li><code>npts</code>: number of points (per quadrant)</li></ul><p>returns tuple with arrays of (r, z, zref)</p><pre><code class="language-julia hljs">&gt;&gt; boundary_shape(;a=0.608,eps=0.374,kapu=1.920,kapl=1.719,delu=0.769,dell=0.463,zetaou=-0.155,zetaiu=-0.255,zetail=-0.174,zetaol=-0.227,zoffset=0.000,upnull=true,lonull=false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/boundary.jl#L15-L53">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.boundary"><a class="docstring-binding" href="#IMAS.boundary"><code>IMAS.boundary</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">boundary(pc::IMAS.pulse_schedule__position_control{T}, time0::Float64)</code></pre><p>return boundary from pulse<em>schedule.position</em>control at a given time0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/boundary.jl#L267-L271">source</a></section><section><div><pre><code class="language-julia hljs">boundary(pc::IMAS.pulse_schedule__position_control{T}, time_index::Int)</code></pre><p>returns boundary from pulse<em>schedule.position</em>control at a given time_index</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/boundary.jl#L279-L283">source</a></section><section><div><pre><code class="language-julia hljs">boundary(pc::IMAS.pulse_schedule__position_control; time0::Float64=global_time(pc))</code></pre><p>Beturns r,z vectors from pulse<em>schedule.position</em>control.equilibrium<strong>time_slice___boundary</strong>outline</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/boundary.jl#L291-L295">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.x_points"><a class="docstring-binding" href="#IMAS.x_points"><code>IMAS.x_points</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">x_points(x_points::IMAS.IDSvector{&lt;:IMAS.pulse_schedule__position_control__x_point{T}}; time0::Float64=global_time(x_points)) where {T&lt;:Real}</code></pre><p>Beturns vector with tuples of R,Z coordinates of x-points in pulse_schedule at time0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/boundary.jl#L303-L307">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.strike_points"><a class="docstring-binding" href="#IMAS.strike_points"><code>IMAS.strike_points</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">strike_points(strike_points::IMAS.IDSvector{&lt;:IMAS.pulse_schedule__position_control__strike_point{T}}; time0::Float64=global_time(strike_points)) where {T&lt;:Real}</code></pre><p>Beturns vector with tuples of R,Z coordinates of x-points in pulse_schedule at time0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/boundary.jl#L323-L327">source</a></section></details></article><h2 id="Physics-build"><a class="docs-heading-anchor" href="#Physics-build">Physics build</a><a id="Physics-build-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-build" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.BuildLayerType"><a class="docstring-binding" href="#IMAS.BuildLayerType"><code>IMAS.BuildLayerType</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Enum BuildLayerType</code></pre><p>Used for <code>dd.build.layer[:].type</code></p><ul><li><code>_plasma_</code> -&gt; -1</li><li><code>_gap_</code> -&gt; 0</li><li><code>_oh_</code> -&gt; 1</li><li><code>_tf_</code> -&gt; 2</li><li><code>_shield_</code> -&gt; 3</li><li><code>_blanket_</code> -&gt; 4</li><li><code>_wall_</code> -&gt; 5</li><li><code>_vessel_</code> -&gt; 6</li><li><code>_cryostat_</code> -&gt; 7</li><li><code>_divertor_</code> -&gt; 8</li><li><code>_port_</code> -&gt; 9</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L6-L12">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.BuildLayerSide"><a class="docstring-binding" href="#IMAS.BuildLayerSide"><code>IMAS.BuildLayerSide</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Enum BuildLayerSide</code></pre><p>Used for <code>dd.build.layer[:].side</code></p><ul><li><code>_lfs_</code> -&gt; -1</li><li><code>_lhfs_</code> -&gt; 0</li><li><code>_hfs_</code> -&gt; 1</li><li><code>_in_</code> -&gt; 2</li><li><code>_out_</code> -&gt; 3</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L18-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.BuildLayerShape"><a class="docstring-binding" href="#IMAS.BuildLayerShape"><code>IMAS.BuildLayerShape</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Enum BuildLayerShape</code></pre><p>Used for <code>dd.build.layer[:].shape</code></p><ul><li><code>_offset_</code> -&gt; 0</li><li><code>_negative_offset_</code> -&gt; 1</li><li><code>_convex_hull_</code> -&gt; 2</li><li><code>_mirror_princeton_D_exact_</code> -&gt; 3</li><li><code>_princeton_D_</code> -&gt; 4</li><li><code>_mirror_princeton_D_</code> -&gt; 5</li><li><code>_princeton_D_scaled_</code> -&gt; 6</li><li><code>_mirror_princeton_D_scaled_</code> -&gt; 7</li><li><code>_rectangle_</code> -&gt; 8</li><li><code>_double_ellipse_</code> -&gt; 9</li><li><code>_mirror_double_ellipse_</code> -&gt; 10</li><li><code>_rectangle_ellipse_</code> -&gt; 11</li><li><code>_mirror_rectangle_ellipse_</code> -&gt; 12</li><li><code>_circle_ellipse_</code> -&gt; 13</li><li><code>_mirror_circle_ellipse_</code> -&gt; 14</li><li><code>_triple_arc_</code> -&gt; 15</li><li><code>_mirror_triple_arc_</code> -&gt; 16</li><li><code>_miller_</code> -&gt; 17</li><li><code>_silo_</code> -&gt; 18</li><li><code>_racetrack_</code> -&gt; 19</li><li><code>_undefined_</code> -&gt; 20</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L30-L36">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.build_radii"><a class="docstring-binding" href="#IMAS.build_radii"><code>IMAS.build_radii</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">build_radii(layers::IMAS.IDSvector{&lt;:IMAS.build__layer{T}}) where {T&lt;:Real}</code></pre><p>Convert thicknesses to absolute radii in the build layers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L39-L43">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.get_build_indexes"><a class="docstring-binding" href="#IMAS.get_build_indexes"><code>IMAS.get_build_indexes</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_build_indexes(
    layers::IMAS.IDSvector{&lt;:IMAS.build__layer};
    type::Union{Nothing,BuildLayerType}=nothing,
    name::Union{Nothing,String}=nothing,
    identifier::Union{Nothing,Integer}=nothing,
    fs::Union{Nothing,BuildLayerSide,AbstractVector{BuildLayerSide}}=nothing)</code></pre><p>Returns indexes of layer(s) in build based on a series of selection criteria</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L55-L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.get_build_index"><a class="docstring-binding" href="#IMAS.get_build_index"><code>IMAS.get_build_index</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_build_index(
    layers::IMAS.IDSvector{&lt;:IMAS.build__layer};
    type::Union{Nothing,BuildLayerType}=nothing,
    name::Union{Nothing,String}=nothing,
    identifier::Union{Nothing,Integer}=nothing,
    fs::Union{Nothing,BuildLayerSide,AbstractVector{BuildLayerSide}}=nothing)</code></pre><p>Returns index of layer in build based on a series of selection criteria</p><p>It raises an error if none or more than one layer matches.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L88-L99">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.get_build_layers"><a class="docstring-binding" href="#IMAS.get_build_layers"><code>IMAS.get_build_layers</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_build_layers(
    layers::IMAS.IDSvector{&lt;:IMAS.build__layer};
    type::Union{Nothing,BuildLayerType}=nothing,
    name::Union{Nothing,String}=nothing,
    identifier::Union{Nothing,Integer}=nothing,
    fs::Union{Nothing,BuildLayerSide,AbstractVector{BuildLayerSide}}=nothing)</code></pre><p>Select layer(s) in build based on a series of selection criteria</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L121-L130">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.get_build_layer"><a class="docstring-binding" href="#IMAS.get_build_layer"><code>IMAS.get_build_layer</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_build_layer(
    layers::IMAS.IDSvector{&lt;:IMAS.build__layer};
    type::Union{Nothing,BuildLayerType}=nothing,
    name::Union{Nothing,String}=nothing,
    identifier::Union{Nothing,Integer}=nothing,
    fs::Union{Nothing,BuildLayerSide,AbstractVector{BuildLayerSide}}=nothing)</code></pre><p>Select layer in build based on a series of selection criteria</p><p>It raises an error if none or more than one layer matches.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L146-L157">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.opposite_side_layer"><a class="docstring-binding" href="#IMAS.opposite_side_layer"><code>IMAS.opposite_side_layer</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">opposite_side_layer(layer::IMAS.build__layer)</code></pre><p>Returns corresponding layer on the high/low field side</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L173-L177">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.func_nested_layers"><a class="docstring-binding" href="#IMAS.func_nested_layers"><code>IMAS.func_nested_layers</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">func_nested_layers(layer::IMAS.build__layer{D}, func::Function)::D where {D&lt;:Real}</code></pre><p>Apply function <code>func</code> to a layer, then subtract <code>func</code> applied to the layer inside of it.</p><p>This is used to caclulate <code>area</code>, <code>volume</code>, etc.. of each layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L249-L255">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-1fa0e2b6785006f2"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-1fa0e2b6785006f2" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.area</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.volume"><a class="docstring-binding" href="#IMAS.volume"><code>IMAS.volume</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">volume(layer::IMAS.build__layer)</code></pre><p>Calculate volume of a build layer revolved around z axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L304-L308">source</a></section><section><div><pre><code class="language-julia hljs">volume(layer::IMAS.build__structure)</code></pre><p>Calculate volume of a build structure outline revolved around z axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L318-L322">source</a></section><section><div><pre><code class="language-julia hljs">volume(coil::IMAS.pf_active__coil)</code></pre><p>Returns volume of PF coils</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pf_active.jl#L20-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.first_wall"><a class="docstring-binding" href="#IMAS.first_wall"><code>IMAS.first_wall</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">first_wall(wall::IMAS.wall{T}; simplify_to_inscribed_fractional_area::Float64=1 - 1E-6) where {T&lt;:Real}</code></pre><p>Returns named tuple with outline of the official contiguous first wall limiter contour, or an empty outline if not present</p><p>NOTE: in IMAS <code>wall.description_2d[].limiter.type.index == 0</code> indicates an official contiguous limiter contour</p><p>NOTE: By default the first wall simplifies points on straight lines</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L339-L347">source</a></section><section><div><pre><code class="language-julia hljs">first_wall(pf_active::IMAS.pf_active{T}) where {T&lt;:Real}</code></pre><p>Returns named tuple with outline of the first wall, defined by the pf_active.coils</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L368-L372">source</a></section><section><div><pre><code class="language-julia hljs">first_wall(eqt::IMAS.equilibrium__time_slice; precision::Float=1E-3) where {T&lt;:Real}</code></pre><p>Returns named tuple with outline of the first wall, defined by equilibrium computation domain</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L442-L446">source</a></section><section><div><pre><code class="language-julia hljs">first_wall(eqt::IMAS.equilibrium__time_slice, pf_active::IMAS.pf_active{T}) where {T&lt;:Real}</code></pre><p>Returns named tuple with outline of the first wall, defined as the equilibrium computational domain with cutouts for the pf_active.coils that fall in it</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L463-L467">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.first_wall!"><a class="docstring-binding" href="#IMAS.first_wall!"><code>IMAS.first_wall!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">first_wall!(wall::IMAS.wall{T}, r::AbstractVector{T}, z::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>Set <code>wall.description_2d[?].limiter.unit[1].outline</code> from input <code>r</code> and <code>z</code></p><p>Returns the limiter.unit with the new outline</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L506-L512">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.contiguous_limiter_from_open_limiters!"><a class="docstring-binding" href="#IMAS.contiguous_limiter_from_open_limiters!"><code>IMAS.contiguous_limiter_from_open_limiters!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">contiguous_limiter_from_open_limiters!(wall::IMAS.wall{T}) where {T&lt;:Real}</code></pre><p>Combines multiple open limiter units into a single contiguous closed limiter by connecting  their outlines in sequence. The function chooses the connection order to minimize gaps  between adjacent limiter segments.</p><p>Modifies the wall structure in-place by replacing existing limiters with one closed  contiguous limiter named &quot;contiguous first wall&quot; and limiter.type.index=0</p><p>Returns the limiter.unit with the contiguous outline.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L527-L538">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.build_max_R0_B0"><a class="docstring-binding" href="#IMAS.build_max_R0_B0"><code>IMAS.build_max_R0_B0</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">build_max_R0_B0(bd::IMAS.build)</code></pre><p>Returns the plasma geometric center (r0) and the maximum vacuum toroidal magnetic field (b0) evaluated at (r0) that the TF build allows</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L561-L565">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.vertical_maintenance"><a class="docstring-binding" href="#IMAS.vertical_maintenance"><code>IMAS.vertical_maintenance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vertical_maintenance(bd::IMAS.build; tor_modularity::Int=2, pol_modularity::Int=1, gap_VV_BL::Float64=0.1)</code></pre><p>Returns the radial dimensions of the vertical vacuum port for blanket maintenance</p><p>gap<em>VV</em>BL is the margin between the blanket module and the wall (10cm seems reasonable)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L577-L583">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.outline"><a class="docstring-binding" href="#IMAS.outline"><code>IMAS.outline</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">outline(layer::Union{IMAS.build__layer, IMAS.build__structure})

outline(out::Union{IMAS.build__layer___outline,IMAS.build__structure___outline})</code></pre><p>Returns a closed polygon as a named tuple with (r,z) of a <code>dd.build.layer</code> or <code>dd.build.structure</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/build.jl#L622-L628">source</a></section><section><div><pre><code class="language-julia hljs">outline(element::Union{IMAS.pf_active__coil___element{T},IMAS.pf_passive__loop___element{T}}) where {T&lt;:Real}</code></pre><p>Returns named tuple with r and z arrays outline, independent of geometry_type used to describe the element</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pf_active.jl#L141-L145">source</a></section></details></article><h2 id="Physics-collisions"><a class="docs-heading-anchor" href="#Physics-collisions">Physics collisions</a><a id="Physics-collisions-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-collisions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.lnΛ_ee"><a class="docstring-binding" href="#IMAS.lnΛ_ee"><code>IMAS.lnΛ_ee</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">lnΛ_ee(ne::Real, Te::Real)</code></pre><p>Calculate Couloumb logarithm (lnΛ) for thermal electron-electron collisions [NRL Plasma Formulary]</p><ul><li><p><code>ne</code>: electron density [m^-3]</p></li><li><p><code>Te</code>: electron temperature [eV]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/collisions.jl#L3-L11">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.lnΛ_ei"><a class="docstring-binding" href="#IMAS.lnΛ_ei"><code>IMAS.lnΛ_ei</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nΛ_ei(ne::S, Te::P, ni::AbstractVector{Q}, Ti::AbstractVector{R}, mi::AbstractVector{T}, Zi::AbstractVector{Int}) where {S&lt;:Real,P&lt;:Real,Q&lt;:Real,R&lt;:Real,T&lt;:Real}</code></pre><p>Calculate Couloumb logarithm (lnΛ) for thermal electron-ion collisions [NRL Plasma Formulary]</p><ul><li><p><code>ne</code>: electron density [m^-3]</p></li><li><p><code>Te</code>: electron temperature [eV]</p></li><li><p><code>ni</code>: list of ion densities [m^-3]</p></li><li><p><code>Ti</code>: list of ion temperaturs [eV]</p></li><li><p><code>mi</code>: list of ion masses [amu]</p></li><li><p><code>Zi</code>: list of ion charges</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/collisions.jl#L20-L36">source</a></section><section><div><pre><code class="language-julia hljs">lnΛ_ei(ne::Real, Te::Real)</code></pre><p>Calculate Couloumb logarithm (lnΛ) for thermal electron-ion collisions where Ti*me/mi &lt; 10Zi^2 eV &lt; Te [NRL Plasma Formulary]</p><ul><li><p><code>ne</code>: electron density [m^-3]</p></li><li><p><code>Te</code>: electron temperature [eV]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/collisions.jl#L60-L68">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.lnΛ_ii"><a class="docstring-binding" href="#IMAS.lnΛ_ii"><code>IMAS.lnΛ_ii</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">lnΛ_ii(ne::Real, Te::Real, ni1::Real, Ti1::Real, mi1::Real, Zi1::Real, ni2::Real, Ti2::Real, mi2::Real, Zi2::Real; beta_D::Real=0.0)</code></pre><p>Calculate Couloumb logarithm (lnΛ) for mixed thermal ion1-ion2 collisions [NRL Plasma Formulary]</p><ul><li><p><code>ne</code>: electron density [m^-3]</p></li><li><p><code>Te</code>: electron temperaturs [eV]</p></li><li><p><code>ni1</code>: ion1 density [m^-3]</p></li><li><p><code>Ti1</code>: ion1 temperature [eV]</p></li><li><p><code>mi1</code>: ion1 mass [amu]</p></li><li><p><code>Zi1</code>: ion1 charge</p></li><li><p><code>ni1</code>: ion2 density [m^-3]</p></li><li><p><code>Ti1</code>: ion2 temperature [eV]</p></li><li><p><code>mi1</code>: ion2 mass [amu]</p></li><li><p><code>Zi1</code>: ion2 charge</p></li><li><p><code>beta_D</code>: relative drift velocities between ion species <code>v_D = beta_D*c</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/collisions.jl#L77-L103">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.lnΛ_fi"><a class="docstring-binding" href="#IMAS.lnΛ_fi"><code>IMAS.lnΛ_fi</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">lnΛ_fi(ne::Real, Te::Real, n_i::Real, T_i::Real, m_i::Real, Z_i::Real, beta_f::Real, mf::Real, Zf::Real; verbose=true)</code></pre><p>Calculate Couloumb logarithm (lnΛ) for beam/fast ion in the presence of warm electrons/ions [NRL Plasma Formulary]</p><ul><li><p><code>ne</code>: electron density [m^-3]</p></li><li><p><code>Te</code>: electron temperaturs [eV]</p></li><li><p><code>n_i</code>: ion density [m^-3]</p></li><li><p><code>Ti</code>: ion temperature [eV]</p></li><li><p><code>mi</code>: ion mass [amu]</p></li><li><p><code>Zi</code>: ion charge</p></li><li><p><code>beta_f</code>: relative fast ion velocity <code>v_f = beta_f*c</code></p></li><li><p><code>mf</code>: mass of fast ion [amu]</p></li><li><p><code>Zf</code>: charge of fast ion</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/collisions.jl#L131-L153">source</a></section></details></article><h2 id="Physics-constants"><a class="docs-heading-anchor" href="#Physics-constants">Physics constants</a><a id="Physics-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-constants" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.mks"><a class="docstring-binding" href="#IMAS.mks"><code>IMAS.mks</code></a> — <span class="docstring-category">Constant</span></summary><section><div><p>Named tuple with physics constants in mks (and eV):</p><pre><code class="language-julia hljs">μ_0 = 1.25663706212e-6 [N A^-2]  # Vacuum permeability
c = 2.99792458e8 [m s^-1]        # Speed of light in vacuum
ϵ_0 = 8.8541878128e-12 [F m^-1]  # Vacuum permittivity
k_B = 1.380649e-23 [J K^-1]      # Boltzmann constant
e = 1.602176634e-19 [C]          # Elementary charge
m_e = 9.1093837015e-31 [kg]      # Electron mass
m_p = 1.67262192369e-27 [kg]     # Proton mass
m_n = 1.67492749804e-27 [kg]     # Neutron mass
m_d = 3.3435837768e-27 [kg]      # Deuteron mass
atm = 101325.0 [Pa]              # Standard atmosphere
m_u = 1.6605390666e-27 [kg]      # Atomic mass constant
avog = 6.02214076e23 [mol^-1]    # Avogadro constant
E_α = 3.518e6 [eV]               # Alpha particle energy
E_n = 14.072e6 [eV]              # Neutron energy</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/constants.jl#L5-L22">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.cgs"><a class="docstring-binding" href="#IMAS.cgs"><code>IMAS.cgs</code></a> — <span class="docstring-category">Constant</span></summary><section><div><p>Named tuple with physics constants used for interfacing with CGS codes:</p><pre><code class="language-julia hljs">e=4.8032e-10 # stacoul
k=1.6022e-12 # erg/eV
c=2.9979e10 # cm/s
me=9.1094e-28 # g
mp=1.6726e-24 # g
md=3.3435837768e-24 # g
T_to_Gauss=1e4
Erg_to_J=1e-7
m_to_cm=1e2
m²_to_cm²=1E4
m³_to_cm³=1e6</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/constants.jl#L43-L57">source</a></section></details></article><h2 id="Physics-currents"><a class="docs-heading-anchor" href="#Physics-currents">Physics currents</a><a id="Physics-currents-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-currents" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.j_ohmic_steady_state"><a class="docstring-binding" href="#IMAS.j_ohmic_steady_state"><code>IMAS.j_ohmic_steady_state</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">j_ohmic_steady_state(eqt::IMAS.equilibrium__time_slice{T}, cp1d::IMAS.core_profiles__profiles_1d{T}, ip::T, j_ohmic_shape::AbstractVector{T}=cp1d.conductivity_parallel) where {T&lt;:Real}</code></pre><p>Sets <code>j_ohmic</code> parallel current density to what it would be at steady-state, based on <code>conductivity_parallel</code>, <code>j_non_inductive</code> and a target total <code>ip</code></p><p>Requires constant loop voltage: <code>Vl = 2π * η * &lt;J_oh⋅B&gt; / (F * &lt;R⁻²&gt;) = constant</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L7-L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.JtoR_2_JparB"><a class="docstring-binding" href="#IMAS.JtoR_2_JparB"><code>IMAS.JtoR_2_JparB</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">JtoR_2_JparB(rho_tor_norm::Vector{&lt;:Real}, JtoR::Vector{&lt;:Real}, includes_bootstrap::Bool, eqt::IMAS.equilibrium__time_slice)</code></pre><p>Given <code>&lt;Jt/R&gt;</code> returns <code>&lt;J⋅B&gt;</code></p><p>Transformation obeys <code>&lt;J⋅B&gt; = (1/f)*(&lt;B^2&gt;/&lt;1/R^2&gt;)*(&lt;Jt/R&gt; + dp/dpsi*(1 - f^2*&lt;1/R^2&gt;/&lt;B^2&gt;))</code></p><p>Includes_bootstrap set to true if input current includes bootstrap</p><p>NOTE: <code>Jtor ≂̸ JtoR</code></p><pre><code class="language-julia hljs">&lt;Jt/R&gt; = &lt;Jt/R&gt;/&lt;1/R&gt; * &lt;1/R&gt; = Jtor * &lt;1/R&gt; = Jtor * gm9</code></pre><p>NOTE: <code>Jpar ≂̸ JparB</code></p><pre><code class="language-julia hljs">JparB = Jpar * B0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L51-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.JparB_2_JtoR"><a class="docstring-binding" href="#IMAS.JparB_2_JtoR"><code>IMAS.JparB_2_JtoR</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">JparB_2_JtoR(rho_tor_norm::Vector{&lt;:Real}, JparB::Vector{&lt;:Real}, includes_bootstrap::Bool, eqt::IMAS.equilibrium__time_slice)</code></pre><p>Given <code>&lt;J⋅B&gt;</code> returns <code>&lt;Jt/R&gt;</code></p><p>Transformation obeys <code>&lt;J⋅B&gt; = (1/f)*(&lt;B^2&gt;/&lt;1/R^2&gt;)*(&lt;Jt/R&gt; + dp/dpsi*(1 - f^2*&lt;1/R^2&gt;/&lt;B^2&gt;))</code></p><p>Includes_bootstrap set to true if input current includes bootstrap</p><p>NOTE: <code>Jtor ≂̸ JtoR</code></p><pre><code class="language-julia hljs">&lt;Jt/R&gt; = &lt;Jt/R&gt;/&lt;1/R&gt; * &lt;1/R&gt; = Jtor * &lt;1/R&gt; = Jtor * gm9</code></pre><p>NOTE: <code>Jpar ≂̸ JparB</code></p><pre><code class="language-julia hljs">JparB = Jpar * B0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L92-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Jtor_2_Jpar"><a class="docstring-binding" href="#IMAS.Jtor_2_Jpar"><code>IMAS.Jtor_2_Jpar</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Jtor_2_Jpar(rho_tor_norm::Vector{&lt;:Real}, Jtor::Vector{&lt;:Real}, includes_bootstrap::Bool, eqt::IMAS.equilibrium__time_slice)</code></pre><p>Given <code>Jtor</code> returns <code>Jpar</code></p><p>Includes_bootstrap set to true if input current includes bootstrap</p><p>NOTE: <code>Jtor ≂̸ JtoR</code></p><pre><code class="language-julia hljs">&lt;Jt/R&gt; = &lt;Jt/R&gt;/&lt;1/R&gt; * &lt;1/R&gt; = Jtor * &lt;1/R&gt; = Jtor * gm9</code></pre><p>NOTE: <code>Jpar ≂̸ JparB</code></p><pre><code class="language-julia hljs">JparB = Jpar * B0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L134-L148">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Jpar_2_Jtor"><a class="docstring-binding" href="#IMAS.Jpar_2_Jtor"><code>IMAS.Jpar_2_Jtor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Jpar_2_Jtor(rho_tor_norm::Vector{&lt;:Real}, Jpar::Vector{&lt;:Real}, includes_bootstrap::Bool, eqt::IMAS.equilibrium__time_slice)</code></pre><p>Given <code>Jpar</code> returns <code>Jtor</code></p><p>Includes_bootstrap set to true if input current includes bootstrap</p><p>NOTE: <code>Jtor ≂̸ JtoR</code></p><pre><code class="language-julia hljs">&lt;Jt/R&gt; = &lt;Jt/R&gt;/&lt;1/R&gt; * &lt;1/R&gt; = Jtor * &lt;1/R&gt; = Jtor * gm9</code></pre><p>NOTE: <code>Jpar ≂̸ JparB</code></p><pre><code class="language-julia hljs">JparB = Jpar * B0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L162-L176">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.vloop"><a class="docstring-binding" href="#IMAS.vloop"><code>IMAS.vloop</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vloop(cp1d::IMAS.core_profiles__profiles_1d{T}) where {T&lt;:Real}</code></pre><p><code>Vloop = 2π * η * &lt;J_oh⋅B&gt; / (F * &lt;R⁻²&gt;)</code>: method emphasizes the resistive nature of the plasma</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L190-L194">source</a></section><section><div><pre><code class="language-julia hljs">vloop(eq::IMAS.equilibrium{T}, n::Int=1; time0::Float64=global_time(eq)) where {T&lt;:Real}</code></pre><p><code>Vloop = dψ/dt</code>: method emphasizes the inductive nature of the loop voltage. Assumes COCOS 11.</p><p>n is the number of time<em>slices priors use to take the difference in psi</em>boundary</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L212-L218">source</a></section><section><div><pre><code class="language-julia hljs">vloop(eq::IMAS.equilibrium{T}, n::Int; time0::Float64=global_time(eq)) where {T&lt;:Real}</code></pre><p><code>Vloop = dψ/dt</code>: method emphasizes the inductive nature of the loop voltage. Assumes COCOS 11.</p><p>δt is the time difference used to take the difference in psi_boundary</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L225-L231">source</a></section><section><div><pre><code class="language-julia hljs">vloop(ct::IMAS.controllers{T}; time0::Float64=global_time(ct)) where {T&lt;:Real}</code></pre><p>Returns <code>vloop</code> at <code>time0</code> from controller named <code>ip</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L240-L244">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.vloop_time"><a class="docstring-binding" href="#IMAS.vloop_time"><code>IMAS.vloop_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vloop_time(ct::IMAS.controllers{T}) where {T&lt;:Real}</code></pre><p>Returns named tuple with <code>time</code> and <code>data</code> with <code>vloop</code> from controller named <code>ip</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L253-L257">source</a></section><section><div><pre><code class="language-julia hljs">vloop_time(eq::IMAS.equilibrium{T}) where {T&lt;:Real}</code></pre><p>Returns named tuple with <code>time</code> and <code>data</code> with <code>vloop</code> from equilibrium</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L263-L267">source</a></section><section><div><pre><code class="language-julia hljs">vloop_time(cp::IMAS.core_profiles{T}, eq::IMAS.equilibrium) where {T&lt;:Real}</code></pre><p>Returns named tuple with <code>time</code> and <code>data</code> with <code>vloop</code> from core_profiles</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L281-L285">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Ip_non_inductive"><a class="docstring-binding" href="#IMAS.Ip_non_inductive"><code>IMAS.Ip_non_inductive</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Ip_non_inductive(cp1d::IMAS.core_profiles__profiles_1d{T}, eqt::IMAS.equilibrium__time_slice{T}) where {T&lt;:Real}</code></pre><p>Integrated toroidal non-inductive current</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L295-L299">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Ip_bootstrap"><a class="docstring-binding" href="#IMAS.Ip_bootstrap"><code>IMAS.Ip_bootstrap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Ip_bootstrap(cp1d::IMAS.core_profiles__profiles_1d{T}, eqt::IMAS.equilibrium__time_slice{T}) where {T&lt;:Real}</code></pre><p>Integrated toroidal bootstrap current</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L307-L311">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Ip_ohmic"><a class="docstring-binding" href="#IMAS.Ip_ohmic"><code>IMAS.Ip_ohmic</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Ip_ohmic(cp1d::IMAS.core_profiles__profiles_1d{T}, eqt::IMAS.equilibrium__time_slice{T}) where {T&lt;:Real}</code></pre><p>Integrated toroidal ohmic current</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L319-L323">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Ip"><a class="docstring-binding" href="#IMAS.Ip"><code>IMAS.Ip</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Ip(cp1d::IMAS.core_profiles__profiles_1d{T}, eqt::IMAS.equilibrium__time_slice{T}) where {T&lt;:Real}</code></pre><p>Integrated toroidal total current (based on core_profiles)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L331-L335">source</a></section><section><div><pre><code class="language-julia hljs">Ip(eqt::IMAS.equilibrium__time_slice{T}) where {T&lt;:Real}</code></pre><p>Integrated toroidal total current (based on equilibrium)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L340-L344">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.plasma_lumped_resistance"><a class="docstring-binding" href="#IMAS.plasma_lumped_resistance"><code>IMAS.plasma_lumped_resistance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">plasma_lumped_resistance(dd::IMAS.dd)</code></pre><p>Returns equivalent plasma lumped resistance in ohms</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/currents.jl#L357-L361">source</a></section></details></article><h2 id="Physics-diagnostics"><a class="docs-heading-anchor" href="#Physics-diagnostics">Physics diagnostics</a><a id="Physics-diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-diagnostics" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.extract_subsystem_from_channel_name"><a class="docstring-binding" href="#IMAS.extract_subsystem_from_channel_name"><code>IMAS.extract_subsystem_from_channel_name</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">extract_subsystem_from_channel_name(name::AbstractString)</code></pre><p>Extract subsystem identifier from channel name. Returns the subsystem string, or the full name if no pattern is recognized.</p><p>Handles various naming conventions:</p><ul><li>Position-based: &quot;TS<em>core</em>r+0<em>38&quot; → &quot;TS</em>core&quot;</li><li>Position-based: &quot;TS<em>tangential</em>r+1<em>25&quot; → &quot;TS</em>tangential&quot;</li><li>Simple numbered: &quot;TS<em>CORE</em>01&quot; → &quot;TS_CORE&quot;</li><li>Generic pattern: &quot;DIVERTOR_05&quot; → &quot;DIVERTOR&quot;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/diagnostics.jl#L3-L15">source</a></section></details></article><h2 id="Physics-equilibrium"><a class="docs-heading-anchor" href="#Physics-equilibrium">Physics equilibrium</a><a id="Physics-equilibrium-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-equilibrium" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.ψ_interpolant"><a class="docstring-binding" href="#IMAS.ψ_interpolant"><code>IMAS.ψ_interpolant</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ψ_interpolant(eqt2d::IMAS.equilibrium__time_slice___profiles_2d)</code></pre><p>Returns r, z, and ψ interpolant named tuple</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L3-L7">source</a></section><section><div><pre><code class="language-julia hljs">ψ_interpolant(r::AbstractRange{T1}, z::AbstractRange{T1}, psi::Matrix{T2}) where {T1&lt;:Real,T2&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L16-L18">source</a></section><section><div><pre><code class="language-julia hljs">ψ_interpolant(eqt2dv::IDSvector{&lt;:IMAS.equilibrium__time_slice___profiles_2d})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L24-L26">source</a></section><section><div><pre><code class="language-julia hljs">ψ_interpolant(eqt::IMAS.equilibrium__time_slice)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L32-L34">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ρ_interpolant"><a class="docstring-binding" href="#IMAS.ρ_interpolant"><code>IMAS.ρ_interpolant</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ρ_interpolant(eqt2d::IMAS.equilibrium__time_slice___profiles_2d{T}, phi_norm::T) where {T&lt;:Real}</code></pre><p>Returns r, z, and ρ interpolant named tuple</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L46-L50">source</a></section><section><div><pre><code class="language-julia hljs">ρ_interpolant(r::AbstractRange{T}, z::AbstractRange{T}, rho::Matrix{T}) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L57-L59">source</a></section><section><div><pre><code class="language-julia hljs">ρ_interpolant(eqt2dv::IDSvector{&lt;:IMAS.equilibrium__time_slice___profiles_2d{T}}, phi_norm::T) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L65-L67">source</a></section><section><div><pre><code class="language-julia hljs">ρ_interpolant(eqt::IMAS.equilibrium__time_slice)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L73-L75">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.calc_pprime_ffprim_f"><a class="docstring-binding" href="#IMAS.calc_pprime_ffprim_f"><code>IMAS.calc_pprime_ffprim_f</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calc_pprime_ffprim_f(
    psi::T,
    R::T,
    one_R::T,
    one_R2::T,
    R0::Real,
    B0::Real;
    pressure::Union{Missing,T}=missing,
    dpressure_dpsi::Union{Missing,T}=missing,
    j_tor::Union{Missing,T}=missing,
    j_tor_over_R::Union{Missing,T}=missing,
    f::Union{Missing,T}=missing,
    f_df_dpsi::Union{Missing,T}=missing,
    ) where {T&lt;:AbstractVector{&lt;:Real}}</code></pre><p>This method returns the <code>P&#39;</code> and <code>FF&#39;</code> given <code>P</code> or <code>P&#39;</code> and <code>J</code> or <code>J/R</code> based on the current equilibrium fluxsurfaces geometry</p><p>Arguments:</p><ul><li><code>psi</code>: poloidal flux</li><li><code>R</code>: &lt;R&gt;</li><li><code>one_R</code>: &lt;1/R&gt;</li><li><code>one_R2</code>: &lt;1/R²&gt;</li><li><code>R0</code>: R at which B0 is defined</li><li><code>B0</code>: vacuum magnetic field</li><li><code>pressure</code>: P</li><li><code>dpressure_dpsi</code>: P&#39;</li><li><code>j_tor</code>: toroidal current</li><li><code>j_tor_over_R</code>: flux surface averaged toroidal current density over major radius</li><li><code>f</code>: F</li><li><code>f_df_dpsi</code>: FF&#39;</li></ul><p>returns (P&#39;, FF&#39;, F)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L83-L116">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.p_jtor_2_pprime_ffprim_f"><a class="docstring-binding" href="#IMAS.p_jtor_2_pprime_ffprim_f"><code>IMAS.p_jtor_2_pprime_ffprim_f</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">p_jtor_2_pprime_ffprim_f(eqt1::IMAS.equilibrium__time_slice___profiles_1d, R0::Real, B0::Real)</code></pre><p>Calculate <code>P&#39;</code>, <code>FF&#39;</code> and <code>F</code> from <code>pressure</code> and <code>j_tor</code> in equilibrium</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L168-L172">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.symmetrize_equilibrium!"><a class="docstring-binding" href="#IMAS.symmetrize_equilibrium!"><code>IMAS.symmetrize_equilibrium!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">symmetrize_equilibrium!(eqt::IMAS.equilibrium__time_slice)</code></pre><p>Update equilibrium time slice in place to be symmetric with respect to its magnetic axis.</p><p>This is done by averaging the upper and lower parts of the equilibrium.</p><p>Flux surfaces should re-traced after this operation.</p><p>NOTE: Use with care! This operation will change the flux surfaces (LCFS included) and as such quantities may change</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L188-L198">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.B0_geo"><a class="docstring-binding" href="#IMAS.B0_geo"><code>IMAS.B0_geo</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">B0_geo(eqt::IMAS.equilibrium__time_slice{T})::T where{T&lt;:Real}</code></pre><p>Returns vacuum B0 at the plasma geometric center, which may or may not be <code>eqt.global_quantities.vacuum_toroidal_field.r0</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L221-L225">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.elongation_limit"><a class="docstring-binding" href="#IMAS.elongation_limit"><code>IMAS.elongation_limit</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">elongation_limit(R0_over_a::Real)</code></pre><p>Returns elongation limit due to control limit from simple aspect ratio scaling</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L236-L240">source</a></section><section><div><pre><code class="language-julia hljs">elongation_limit(eqt::IMAS.equilibrium__time_slice)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L245-L247">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.optimal_kappa_delta"><a class="docstring-binding" href="#IMAS.optimal_kappa_delta"><code>IMAS.optimal_kappa_delta</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">optimal_kappa_delta(li::T1, βp::T1, ϵ::T1, γτw::T2, ∆o::T2) where {T1&lt;:Real,T2&lt;:Real}</code></pre><p>An analytic scaling relation for the maximum tokamak elongation against n=0 MHD resistive wall modes Jungpyo Lee, Jeffrey P. Freidberg, Antoine J. Cerfon, Martin Greenwald https://doi.org/10.1088%2F1741-4326%2Faa6877</p><p>NOTE:</p><ul><li><p><code>γτw</code> is the feedback capability parameter and represents how fast a instability is controllable (<code>𝛾</code> is the instability growth rate and <code>τw</code> is the wall diffusion time)  (typically <code>γτw &lt; 10</code> is assumed for controllability, see <code>VacuumFields.normalized_growth_rate()</code>)</p></li><li><p><code>∆o</code> is the outer gap (NOTE: assumes <code>∆o = ∆i = 1/3 * ∆v</code>) detemines the relation between <code>κ</code> and <code>δ</code> of the plasma boundary and the <code>κw=(κ+3∆o)(1+∆o)</code> and <code>δw=δ(1+∆o)</code> of the wall boundary</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L256-L268">source</a></section><section><div><pre><code class="language-julia hljs">optimal_kappa_delta(eqt::IMAS.equilibrium__time_slice, γτw::T, ∆o::T) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/equilibrium.jl#L301-L303">source</a></section></details></article><h2 id="Physics-fast"><a class="docs-heading-anchor" href="#Physics-fast">Physics fast</a><a id="Physics-fast-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-fast" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.estrada_I_integrals"><a class="docstring-binding" href="#IMAS.estrada_I_integrals"><code>IMAS.estrada_I_integrals</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">estrada_I_integrals(ne::Real, Te::Real, ni::AbstractVector{&lt;:Real}, Ti::AbstractVector{&lt;:Real}, mi::AbstractVector{&lt;:Real}, Zi::AbstractVector{Int}, Ef::Real,  mf::Real, Zf::Real)</code></pre><p>Returns solution to <code>i2</code> and <code>i4</code> integrals from  [Estrada et al.,  Phys of Plasm. 13, 112303 (2006)] Eq. 9 &amp; 10</p><ul><li><code>ne</code>: electron density [m^-3]</li><li><code>Te</code>: electron temperature [eV]</li><li><code>ni</code>: list of ion densities [m^-3]</li><li><code>Ti</code>: list of ion temperatures [eV]</li><li><code>mi</code>: list of ion masses [amu]</li><li><code>Zi</code>: list of ion charges</li><li><code>Ef</code>: fast ion energy [eV]</li><li><code>mf</code>: mass of fast ion [amu]</li><li><code>Zf</code>: fast ion charge</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L3-L17">source</a></section><section><div><pre><code class="language-julia hljs">estrada_I_integrals(ne::Real, Te::Real, ni::AbstractVector{&lt;:Real}, Ti::AbstractVector{&lt;:Real}, mi::AbstractVector{&lt;:Real}, Zi::AbstractVector{Int}, Ef::Real,  mf::Real, Zf::Real)</code></pre><p>Returns solution to i2 and i4 integrals from  [Estrada et al.,  Phys of Plasm. 13, 112303 (2006)] Eq. 9 &amp; 10</p><ul><li><code>Ef</code>: fast ion energy [eV]</li><li><code>Ec</code>: critical energy [eV]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L29-L36">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.α_slowing_down_time"><a class="docstring-binding" href="#IMAS.α_slowing_down_time"><code>IMAS.α_slowing_down_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">α_slowing_down_time(cp1d::IMAS.core_profiles__profiles_1d, irho::Int=1)</code></pre><p>Returns the slowing down time in seconds of α particles evaluated at irho (by default on axis)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L86-L90">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.critical_energy"><a class="docstring-binding" href="#IMAS.critical_energy"><code>IMAS.critical_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">critical_energy(cp1d::IMAS.core_profiles__profiles_1d, irho::Int, mf::Real, Zf::Real; approximate::Bool=true)</code></pre><p>Returns <code>Ec</code> the critical energy by finding the root of the difference between the electron and ion drag</p><ul><li><code>mf</code>: mass of fast ion [amu]</li><li><code>Zf</code>: fast ion charge</li><li><code>approximate</code>: calculate critical energy assuming <code>lnΛ_fe == lnΛ_fi</code>. For DIII-D this results in a correction factor of (lnΛ<em>fi/lnΛ</em>fe)^(2/3) ≈ 1.2.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L157-L165">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.thermalization_time"><a class="docstring-binding" href="#IMAS.thermalization_time"><code>IMAS.thermalization_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">thermalization_time(v_f, v_c, tau_s)</code></pre><p>Calculate thermalization time in seconds</p><ul><li><code>v_f</code>: fast ion velocity</li><li><code>v_c</code>: critical velocity</li><li><code>tau_s</code>: slowing down time</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L194-L202">source</a></section><section><div><pre><code class="language-julia hljs">thermalization_time(cp1d::IMAS.core_profiles__profiles_1d, irho::Int, Ef::Real, mf::Real, Zf::Real)</code></pre><p>Calculate thermalization time in seconds of a fast ion with energy Ef and <code>Ti*me/mi &lt; 10Zi^2 eV &lt; Te</code></p><ul><li><code>Ef</code>: fast ion energy [eV]</li><li><code>mf</code>: mass of fast ion [amu]</li><li><code>Zf</code>: fast ion charge</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L209-L217">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.α_thermalization_time"><a class="docstring-binding" href="#IMAS.α_thermalization_time"><code>IMAS.α_thermalization_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">α_thermalization_time(cp1d::IMAS.core_profiles__profiles_1d, irho::Int)</code></pre><p>Returns the thermalization time in seconds of α particles evaluated on axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L245-L249">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fast_ion_thermalization_time"><a class="docstring-binding" href="#IMAS.fast_ion_thermalization_time"><code>IMAS.fast_ion_thermalization_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fast_ion_thermalization_time(cp1d::IMAS.core_profiles__profiles_1d, irho::Int, ion::Union{IMAS.nbi__unit___species,IMAS.core_profiles__profiles_1d___ion___element}, ion_energy::Real)</code></pre><p>Returns the fast ion thermalization time in seconds evaluated on axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L263-L267">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fast_particles_profiles!"><a class="docstring-binding" href="#IMAS.fast_particles_profiles!"><code>IMAS.fast_particles_profiles!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fast_particles_profiles!(cs::IMAS.core_sources, cp1d::IMAS.core_profiles__profiles_1d; verbose::Bool=false)</code></pre><p>Fills the core_profiles fast ion densities and pressures that result from fast ion sources (eg. fusion and nbi)</p><p>This calculation is done based on the <code>slowing_down_time</code> and <code>thermalization_time</code> of the fast ion species.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L288-L294">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sivukhin_fraction"><a class="docstring-binding" href="#IMAS.sivukhin_fraction"><code>IMAS.sivukhin_fraction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sivukhin_fraction(cp1d::IMAS.core_profiles__profiles_1d, particle_energy::Real, particle_mass::Real)</code></pre><p>Compute a low-accuracy but fast approximation of the ion to electron heating fraction for fast particles (like alpha particles and beam particles)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L364-L368">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.smooth_beam_power"><a class="docstring-binding" href="#IMAS.smooth_beam_power"><code>IMAS.smooth_beam_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">smooth_beam_power(time::AbstractVector{Float64}, power::AbstractVector{T}, taus::Float64) where {T&lt;:Real}</code></pre><p>Smooths out the beam power history based on a given thermalization constant <code>taus</code></p><p>Such smoothing mimics the delayed contribution from the instantaneous source, as well as the gradual decay of the previous fast ion population over time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L413-L420">source</a></section><section><div><pre><code class="language-julia hljs">smooth_beam_power(time::AbstractVector{Float64}, power::AbstractVector{T}, time0::Float64, taus::Float64) where {T&lt;:Real}</code></pre><p>Return smoothed beam power at time0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fast.jl#L449-L453">source</a></section></details></article><h2 id="Physics-fields"><a class="docs-heading-anchor" href="#Physics-fields">Physics fields</a><a id="Physics-fields-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-fields" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.Br_Bz"><a class="docstring-binding" href="#IMAS.Br_Bz"><code>IMAS.Br_Bz</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Br_Bz(eqt2d::IMAS.equilibrium__time_slice___profiles_2d)</code></pre><p>Returns Br and Bz named tuple evaluated at r and z starting from ψ interpolant</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L7-L11">source</a></section><section><div><pre><code class="language-julia hljs">Br_Bz(eqt2dv::IDSvector{&lt;:IMAS.equilibrium__time_slice___profiles_2d})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L17-L19">source</a></section><section><div><pre><code class="language-julia hljs">Br_Bz(PSI_interpolant::Interpolations.AbstractInterpolation, r::T, z::T) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L25-L27">source</a></section><section><div><pre><code class="language-julia hljs">Br_Bz(PSI_interpolant::Interpolations.AbstractInterpolation, r::AbstractArray{T}, z::AbstractArray{T}) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L36-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Br_Bphi_Bz"><a class="docstring-binding" href="#IMAS.Br_Bphi_Bz"><code>IMAS.Br_Bphi_Bz</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Br_Bphi_Bz(PSI_interpolant::Interpolations.AbstractInterpolation, B0::T, R0::T, r::T, z::T) where {T&lt;:Real}</code></pre><p>Returns Br, Bphi, Bz named tuple evaluated at r and z starting from ψ interpolant and B0 and R0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L51-L55">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Bx_By_Bz"><a class="docstring-binding" href="#IMAS.Bx_By_Bz"><code>IMAS.Bx_By_Bz</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Bx_By_Bz(PSI_interpolant::Interpolations.AbstractInterpolation, B0::T, R0::T, r::T, z::T) where {T&lt;:Real}</code></pre><p>Returns Bx, By, Bz named tuple evaluated at x,y,z starting from ψ interpolant and B0 and R0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L68-L72">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Bp"><a class="docstring-binding" href="#IMAS.Bp"><code>IMAS.Bp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Bp(eqt2d::IMAS.equilibrium__time_slice___profiles_2d)</code></pre><p>Returns Bp evaluated at r and z starting from ψ interpolant</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L105-L109">source</a></section><section><div><pre><code class="language-julia hljs">Bp(PSI_interpolant::Interpolations.AbstractInterpolation, r::T, z::T) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L115-L117">source</a></section><section><div><pre><code class="language-julia hljs">Bp(eqt2dv::IDSvector{&lt;:IMAS.equilibrium__time_slice___profiles_2d})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L136-L138">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.trace_field_line"><a class="docstring-binding" href="#IMAS.trace_field_line"><code>IMAS.trace_field_line</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">trace_field_line(vector_field, start_point, step_size, stop_condition)</code></pre><p>Compute a trajectory along a vector field using the implicit midpoint method.</p><p><strong>Arguments</strong></p><ul><li><code>vector_field</code>: Vector field function</li><li><code>start_point</code>: Initial point of the trajectory</li><li><code>step_size</code>: Size of each integration step</li><li><code>stop_condition</code>: Function determining when to stop integration. Takes a ImplicitMidpointState struct as an argument.</li></ul><p><strong>Returns</strong></p><p>Trajectory represented as a vector of points</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L209-L224">source</a></section><section><div><pre><code class="language-julia hljs">trace_field_line(eqt::IMAS.equilibrium__time_slice, r, z; phi=zero(r), step_size=0.01, max_turns=1, stop_condition=nothing)</code></pre><p>Compute a field line trajectory for a specific equilibrium time slice.</p><p><strong>Arguments</strong></p><ul><li><code>eqt</code>: Equilibrium time slice</li><li><code>r</code>: Radial coordinate</li><li><code>z</code>: Vertical coordinate</li><li><code>phi</code>: Toroidal angle (default: 0)</li><li><code>step_size</code>: Size of each integration step (default: 0.01)</li><li><code>max_turns</code>: Maximum number of toroidal turns used in default stop condition (default: 1)</li><li><code>stop_condition</code>: User defined stop condition that takes a ImplicitMidpointState struct and returns a Boolean (default: nothing)</li></ul><p><strong>Returns</strong></p><p>Named tuple with x, y, z, r, and phi coordinates of the trajectory</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fields.jl#L245-L263">source</a></section></details></article><h2 id="Physics-flux-surfaces"><a class="docs-heading-anchor" href="#Physics-flux-surfaces">Physics flux-surfaces</a><a id="Physics-flux-surfaces-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-flux-surfaces" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.find_psi_boundary"><a class="docstring-binding" href="#IMAS.find_psi_boundary"><code>IMAS.find_psi_boundary</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_psi_boundary(
    dimR::Union{AbstractVector{T1},AbstractRange{T1}},
    dimZ::Union{AbstractVector{T1},AbstractRange{T1}},
    PSI::Matrix{T2},
    psi_axis::Real,
    original_psi_boundary::Real,
    RA::T3,
    ZA::T3,
    fw_r::AbstractVector{T4},
    fw_z::AbstractVector{T5};
    PSI_interpolant=IMAS.ψ_interpolant(dimR, dimZ, PSI).PSI_interpolant,
    precision::Float64=flux_surfaces_precision,
    raise_error_on_not_open::Bool,
    raise_error_on_not_closed::Bool,
    verbose::Bool=false
) where {T1&lt;:Real,T2&lt;:Real,T3&lt;:Real,T4&lt;:Real,T5&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L9-L26">source</a></section><section><div><pre><code class="language-julia hljs">find_psi_boundary(
    dimR::Union{AbstractVector{T1},AbstractRange{T1}},
    dimZ::Union{AbstractVector{T1},AbstractRange{T1}},
    PSI::Matrix{T2},
    psi_axis::Real,
    axis2bnd::Symbol,
    RA::T3,
    ZA::T3,
    fw_r::AbstractVector{T4}=T1[],
    fw_z::AbstractVector{T5}=T1[],
    r_cache::AbstractVector{T1}=T1[],
    z_cache::AbstractVector{T1}=T1[];
    PSI_interpolant=IMAS.ψ_interpolant(dimR, dimZ, PSI).PSI_interpolant,
    precision::Float64=flux_surfaces_precision,
    raise_error_on_not_open::Bool,
    raise_error_on_not_closed::Bool,
    verbose::Bool=false
) where {T1&lt;:Real,T2&lt;:Real,T3&lt;:Real,T4&lt;:Real,T5&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L89-L108">source</a></section><section><div><pre><code class="language-julia hljs">find_psi_boundary(
    dimR::Union{AbstractVector{T1},AbstractRange{T1}},
    dimZ::Union{AbstractVector{T1},AbstractRange{T1}},
    PSI::Matrix{T2},
    psirange_init::AbstractVector,
    RA::T3,
    ZA::T3,
    fw_r::AbstractVector{T4},
    fw_z::AbstractVector{T5},
    r_cache::AbstractVector{T1}=T1[],
    z_cache::AbstractVector{T1}=T1[];
    PSI_interpolant=IMAS.ψ_interpolant(dimR, dimZ, PSI).PSI_interpolant,
    precision::Float64=flux_surfaces_precision,
    raise_error_on_not_open::Bool,
    raise_error_on_not_closed::Bool,
    verbose::Bool=false
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L161-L179">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_psi_separatrix"><a class="docstring-binding" href="#IMAS.find_psi_separatrix"><code>IMAS.find_psi_separatrix</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_psi_separatrix(eqt::IMAS.equilibrium__time_slice{T}; precision::Float64=flux_surfaces_precision) where {T&lt;:Real}</code></pre><p>Returns psi of the first magentic separatrix</p><p>Note: The first separatrix is the LCFS only in diverted plasmas</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L279-L285">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_psi_2nd_separatrix"><a class="docstring-binding" href="#IMAS.find_psi_2nd_separatrix"><code>IMAS.find_psi_2nd_separatrix</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_psi_2nd_separatrix(eqt::IMAS.equilibrium__time_slice{T}; precision::Float64=flux_surfaces_precision) where {T&lt;:Real}</code></pre><p>Returns psi of the second magentic separatrix</p><p>returns <code>diverted</code> and <code>not_diverted</code> surface in a NamedTuple</p><ul><li><p><code>diverted</code> is when the surface starts and finishes on the same side of the midplane</p></li><li><p><code>not_diverted</code> is when the surface starts and finishes on opposite sides of the midplane</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L321-L331">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_psi_last_diverted"><a class="docstring-binding" href="#IMAS.find_psi_last_diverted"><code>IMAS.find_psi_last_diverted</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_psi_last_diverted(
    eqt::IMAS.equilibrium__time_slice,
    wall_r::AbstractVector{&lt;:Real},
    wall_z::AbstractVector{&lt;:Real},
    PSI_interpolant::Interpolations.AbstractInterpolation;
    precision::Float64=flux_surfaces_precision)</code></pre><p>Returns <code>psi_last_lfs,</code>psi<em>first</em>lfs<em>far<code>, and</code>null</em>within_wall`</p><ul><li><p><code>psi_first_lfs_far</code> will be the first surface inside <code>OFL[:lfs_far]</code></p></li><li><p><code>psi_last_lfs</code> will be the last surface inside <code>OFL[:lfs]</code></p></li></ul><p>Precision between the two is defined on the poloidal crossection area at the OMP (<code>Psol*precision</code> = power flowing between <code>psi_first_lfs_far</code> and <code>psi_last_lfs</code> ~ 0)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L412-L427">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_psi_tangent_omp"><a class="docstring-binding" href="#IMAS.find_psi_tangent_omp"><code>IMAS.find_psi_tangent_omp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_psi_tangent_omp(
    eqt::IMAS.equilibrium__time_slice,
    wall_r::AbstractVector{&lt;:Real},
    wall_z::AbstractVector{&lt;:Real},
    PSI_interpolant::Interpolations.AbstractInterpolation;
    precision::Float64=flux_surfaces_precision)</code></pre><p>Returns the psi of the magnetic surface in the SOL which is tangent to the wall near the outer midplane</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L629-L638">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_psi_max"><a class="docstring-binding" href="#IMAS.find_psi_max"><code>IMAS.find_psi_max</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_psi_max(eqt::IMAS.equilibrium__time_slice{T}; precision::Float64=1e-2) where {T&lt;:Real}</code></pre><p>Returns the max psi useful for an ofl in the SOL with no wall.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L733-L737">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_psi_wall_omp"><a class="docstring-binding" href="#IMAS.find_psi_wall_omp"><code>IMAS.find_psi_wall_omp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_psi_wall_omp(eqt::IMAS.equilibrium__time_slice, wall_r::AbstractVector{&lt;:Real}, wall_z::AbstractVector{&lt;:Real})</code></pre><p>Returns the psi of the magnetic surface in the SOL which intersects the wall at the outer midplane</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L851-L855">source</a></section><section><div><pre><code class="language-julia hljs">find_psi_wall_omp(
    PSI_interpolant::Interpolations.AbstractInterpolation,
    RA::T1,
    ZA::T1,
    wall_r::AbstractVector{T2},
    wall_z::AbstractVector{T2},
    psi_max::T1,
    psi_sign::T1
) where {T1&lt;:Real,T2&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L870-L880">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.interp_rmid_at_psi"><a class="docstring-binding" href="#IMAS.interp_rmid_at_psi"><code>IMAS.interp_rmid_at_psi</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">interp_rmid_at_psi(eqt::IMAS.equilibrium__time_slice, PSI_interpolant::Interpolations.AbstractInterpolation, R::AbstractVector{&lt;:Real})</code></pre><p>Returns the interpolant r_mid(ψ) to compute the r at the midplane of the flux surface identified by ψ</p><p>The vector <code>R</code> defines the sampling of interest for thie interpolation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L909-L915">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.SimpleSurface"><a class="docstring-binding" href="#IMAS.SimpleSurface"><code>IMAS.SimpleSurface</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct SimpleSurface{T&lt;:Real} &lt;: AbstractFluxSurface{T}
    psi::T
    r::Vector{T}
    z::Vector{T}
    ll::Vector{T}
    fluxexpansion::Vector{T}
    int_fluxexpansion_dl::T
end</code></pre><p>A simplified version of FluxSurface that only has the contour points and what is needed to compute flux surface averages</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L961-L973">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.FluxSurface"><a class="docstring-binding" href="#IMAS.FluxSurface"><code>IMAS.FluxSurface</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct FluxSurface{T&lt;:Real} &lt;: AbstractFluxSurface{T}
    psi::T
    r::Vector{T}
    z::Vector{T}
    r_at_max_z::T
    max_z::T
    r_at_min_z::T
    min_z::T
    z_at_max_r::T
    max_r::T
    z_at_min_r::T
    min_r::T
    Br::Vector{T}
    Bz::Vector{T}
    Bp::Vector{T}
    Btot::Vector{T}
    ll::Vector{T}
    fluxexpansion::Vector{T}
    int_fluxexpansion_dl::T
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L993-L1014">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.trace_simple_surfaces"><a class="docstring-binding" href="#IMAS.trace_simple_surfaces"><code>IMAS.trace_simple_surfaces</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">trace_simple_surfaces(eqt::IMAS.equilibrium__time_slice{T}, wall_r::AbstractVector{T}, wall_z::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>Trace flux surfaces and returns vector of SimpleSurface structures. The result contains only the contours and what is needed to perform flux-surface averaging.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1065-L1070">source</a></section><section><div><pre><code class="language-julia hljs">trace_simple_surfaces(
    psi::AbstractVector{T},
    r::AbstractVector{T},
    z::AbstractVector{T},
    PSI::Matrix{T},
    PSI_interpolant::Interpolations.AbstractInterpolation,
    RA::T,
    ZA::T,
    wall_r::AbstractVector{T},
    wall_z::AbstractVector{T}
) where {T&lt;:Real}</code></pre><p>Trace flux surfaces and returns vector of SimpleSurface structures. The result contains only the contours and what is needed to perform flux-surface averaging.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1079-L1094">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.trace_simple_surfaces!"><a class="docstring-binding" href="#IMAS.trace_simple_surfaces!"><code>IMAS.trace_simple_surfaces!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">trace_simple_surfaces!(
    surfaces::Vector{SimpleSurface{T}},
    psi::AbstractVector{T},
    r::AbstractVector{T},
    z::AbstractVector{T},
    PSI::Matrix{T},
    PSI_interpolant::Interpolations.AbstractInterpolation,
    RA::T,
    ZA::T,
    wall_r::AbstractVector{T},
    wall_z::AbstractVector{T},
    r_cache::AbstractVector{T}=T[],
    z_cache::AbstractVector{T}=T[])
) where {T&lt;:Real}</code></pre><p>Trace flux surfaces and store in <code>surfaces</code> vector of SimpleSurface structures. The result contains only the contours and what is needed to perform flux-surface averaging.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1114-L1132">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.trace_surfaces"><a class="docstring-binding" href="#IMAS.trace_surfaces"><code>IMAS.trace_surfaces</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">trace_surfaces(eqt::IMAS.equilibrium__time_slice{T}, wall_r::AbstractVector{T}, wall_z::AbstractVector{T}; refine_extrema::Bool=true) where {T&lt;:Real}</code></pre><p>Trace flux surfaces and returns vector of FluxSurface structures</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1196-L1200">source</a></section><section><div><pre><code class="language-julia hljs">trace_surfaces(
    psi::AbstractVector{T},
    f::AbstractVector{T},
    r::AbstractVector{T},
    z::AbstractVector{T},
    PSI::Matrix{T},
    BR::Matrix{T},
    BZ::Matrix{T},
    PSI_interpolant::Interpolations.AbstractInterpolation,
    RA::T,
    ZA::T,
    wall_r::AbstractVector{T},
    wall_z::AbstractVector{T};
    refine_extrema::Bool=true
) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1210-L1226">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.flux_surfaces"><a class="docstring-binding" href="#IMAS.flux_surfaces"><code>IMAS.flux_surfaces</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">flux_surfaces(eq::equilibrium{T}, wall_r::AbstractVector{T}, wall_z::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>Update flux surface averaged and geometric quantities for all time_slices in the equilibrium IDS</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1537-L1541">source</a></section><section><div><pre><code class="language-julia hljs">flux_surfaces(eqt::equilibrium__time_slice{T1}, wall_r::AbstractVector{T2}, wall_z::AbstractVector{T2}) where {T1&lt;:Real,T2&lt;:Real}</code></pre><p>Update flux surface averaged and geometric quantities for a given equilibrum IDS time slice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1553-L1557">source</a></section><section><div><pre><code class="language-julia hljs">flux_surfaces(eqt::equilibrium__time_slice, wall::IMAS.wall)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1838-L1840">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.flux_surface"><a class="docstring-binding" href="#IMAS.flux_surface"><code>IMAS.flux_surface</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">flux_surface(eqt::equilibrium__time_slice{T}, psi_level::Real, type::Symbol, wall_r::AbstractVector{T}, wall_z::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>Returns a vector with the (r,z) coordiates of flux surface at given psi_level</p><p>The <code>type</code> parameter:</p><ul><li><code>:any</code>: return all contours</li><li><code>:closed</code>: all closed flux-surface that encircle the magnetic axis and do not cross the wall</li><li><code>:open</code>: all open flux-surfaces (considerning open even closed flux surfaces that hit the first wall)</li><li><code>:open_no_wall</code>: all open flux-surfaces independently of wall</li><li><code>:encircling</code>: open flux-surfaces encircling the magnetic axis</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1849-L1861">source</a></section><section><div><pre><code class="language-julia hljs">flux_surface(
    dim1::AbstractVector{T1},
    dim2::AbstractVector{T1},
    PSI::AbstractArray{T2},
    RA::T3,
    ZA::T3,
    fw_r::AbstractVector{T4},
    fw_z::AbstractVector{T4},
    psi_level::T5,
    type::Symbol
) where {T1&lt;:Real,T2&lt;:Real,T3&lt;:Real,T4&lt;:Real,T5&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1874-L1886">source</a></section><section><div><pre><code class="language-julia hljs">flux_surface(
    dim1::Union{AbstractVector{T},AbstractRange{T}},
    dim2::Union{AbstractVector{T},AbstractRange{T}},
    cl::Contour.ContourLevel,
    RA::T,
    ZA::T,
    fw_r::AbstractVector{T},
    fw_z::AbstractVector{T},
    type::Symbol) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L1905-L1915">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.flux_surface_avg"><a class="docstring-binding" href="#IMAS.flux_surface_avg"><code>IMAS.flux_surface_avg</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">flux_surface_avg(quantity::AbstractVector{T}, surface::FluxSurface{T}) where {T&lt;:Real}</code></pre><p>Flux surface averaging of a quantity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2001-L2005">source</a></section><section><div><pre><code class="language-julia hljs">flux_surface_avg(f::F1, surface::FluxSurface{T}) where {F1&lt;:Function, T&lt;:Real}</code></pre><p>Flux surface averaging of a function</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2011-L2015">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.volume_integrate"><a class="docstring-binding" href="#IMAS.volume_integrate"><code>IMAS.volume_integrate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">volume_integrate(eqt::IMAS.equilibrium__time_slice, what::AbstractVector{T})::AbstractVector{T} where {T&lt;:Real}</code></pre><p>Integrate quantity over volume</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2023-L2027">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.cumlul_volume_integrate"><a class="docstring-binding" href="#IMAS.cumlul_volume_integrate"><code>IMAS.cumlul_volume_integrate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">volume_integrate(eqt::IMAS.equilibrium__time_slice, what::AbstractVector{T})::AbstractVector{T} where {T&lt;:Real}</code></pre><p>Cumulative integrate quantity over volume</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2037-L2041">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.surface_integrate"><a class="docstring-binding" href="#IMAS.surface_integrate"><code>IMAS.surface_integrate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">surface_integrate(eqt::IMAS.equilibrium__time_slice, what::AbstractVector{T})::AbstractVector{T} where {T&lt;:Real}</code></pre><p>Integrate quantity over surface</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2051-L2055">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.cumlul_surface_integrate"><a class="docstring-binding" href="#IMAS.cumlul_surface_integrate"><code>IMAS.cumlul_surface_integrate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">surface_integrate(eqt::IMAS.equilibrium__time_slice, what::AbstractVector{T})::AbstractVector{T} where {T&lt;:Real}</code></pre><p>Cumulative integrate quantity over surface</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2066-L2070">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_x_point!"><a class="docstring-binding" href="#IMAS.find_x_point!"><code>IMAS.find_x_point!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_x_point!(eqt::IMAS.equilibrium__time_slice{T}, wall_r::AbstractVector{T}, wall_z::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>Find the <code>n</code> X-points that are closest to the separatrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2081-L2085">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.x_points_inside_wall"><a class="docstring-binding" href="#IMAS.x_points_inside_wall"><code>IMAS.x_points_inside_wall</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">x_points_inside_wall(x_points::IDSvector{&lt;:IMAS.equilibrium__time_slice___boundary__x_point}, wall::IMAS.wall)</code></pre><p>Returns vector of x_points that are inside of the first wall</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2209-L2213">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.miller_R_a_κ_δ_ζ"><a class="docstring-binding" href="#IMAS.miller_R_a_κ_δ_ζ"><code>IMAS.miller_R_a_κ_δ_ζ</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">miller_R_a_κ_δ_ζ(pr, pz, r_at_max_z, max_z, r_at_min_z, min_z, z_at_max_r, max_r, z_at_min_r, min_r)</code></pre><p>Returns named tuple with <code>R0</code>, <code>a</code>, <code>κ</code>, <code>δu</code>, <code>δl</code>, <code>ζou</code>, <code>ζol</code>, <code>ζil</code>, <code>ζiu</code> of a contour</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2228-L2232">source</a></section><section><div><pre><code class="language-julia hljs">miller_R_a_κ_δ_ζ(pr::Vector{T}, pz::Vector{T}) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2244-L2246">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fluxsurface_extrema"><a class="docstring-binding" href="#IMAS.fluxsurface_extrema"><code>IMAS.fluxsurface_extrema</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fluxsurface_extrema(pr::Vector{T}, pz::Vector{T}) where {T&lt;:Real}</code></pre><p>Returns extrema indexes and values of R,Z flux surfaces vectors:</p><pre><code class="language-julia hljs">imaxr, iminr,
imaxz, iminz,
r_at_max_z, max_z,
r_at_min_z, min_z,
z_at_max_r, max_r,
z_at_min_r, min_r</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2255-L2266">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.luce_squareness"><a class="docstring-binding" href="#IMAS.luce_squareness"><code>IMAS.luce_squareness</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">luce_squareness(pr::AbstractVector{T}, pz::AbstractVector{T}, r_at_max_z::T, max_z::T, r_at_min_z::T, min_z::T, z_at_max_r::T, max_r::T, z_at_min_r::T, min_r::T) where {T&lt;:Real}</code></pre><p>Squareness from: &quot;An analytic functional form for characterization and generation of axisymmetric plasma boundaries&quot; T.C. Luce, Plasma Phys. Control. Fusion 55 (2013) http://dx.doi.org/10.1088/0741-3335/55/9/095009</p><p>Returns: zetaou, zetaol, zetail, zetaiu</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2286-L2293">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.areal_elongation"><a class="docstring-binding" href="#IMAS.areal_elongation"><code>IMAS.areal_elongation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">areal_elongation(eqt::IMAS.equilibrium__time_slice)</code></pre><p>A measure of the plasma elongation based on the averaged cross-sectional area of the plasma, most notably used in the H98y2 scaling</p><p>See: https://iopscience.iop.org/article/10.1088/0029-5515/48/9/099801/pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/fluxsurfaces.jl#L2329-L2335">source</a></section></details></article><h2 id="Physics-interferometer"><a class="docs-heading-anchor" href="#Physics-interferometer">Physics interferometer</a><a id="Physics-interferometer-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-interferometer" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.line_average"><a class="docstring-binding" href="#IMAS.line_average"><code>IMAS.line_average</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">line_average(
    rho_interp,
    lcfs_r::AbstractVector{&lt;:Real},
    lcfs_z::AbstractVector{&lt;:Real},
    q::AbstractVector{&lt;:Real},
    rho_tor_norm::AbstractVector{&lt;:Real},
    r1::T1, z1::T1, ϕ1::T1,
    r2::T1, z2::T1, ϕ2::T1;
    n_points::Int=100
) where {T1&lt;:Real}</code></pre><p>Low-level function that takes pre-computed ρ interpolant and LCFS boundary arrays.</p><p>This is more efficient when computing line averages for multiple channels or time-slices with the same equilibrium.</p><p>Returns named tuple with (:line<em>integral, :line</em>average, :path_length)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/interferometer.jl#L30-L47">source</a></section><section><div><pre><code class="language-julia hljs">line_average(
    eqt::IMAS.equilibrium__time_slice,
    q::AbstractVector{&lt;:Real},
    rho_tor_norm::AbstractVector{&lt;:Real},
    line_of_sight;
    n_points::Int=100
)</code></pre><p>High-level convenience function for computing line averages</p><p>Returns named tuple with (:line<em>integral, :line</em>average, :path_length)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/interferometer.jl#L112-L124">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ne_line"><a class="docstring-binding" href="#IMAS.ne_line"><code>IMAS.ne_line</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ne_line(::Nothing, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculates the averaged density along rho<em>tor</em>norm (to be used when equilibrium information is not available)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L567-L571">source</a></section><section><div><pre><code class="language-julia hljs">ne_line(eqt::IMAS.equilibrium__time_slice, ne_profile::AbstractVector{&lt;:Real}, rho_ne::AbstractVector{&lt;:Real})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L576-L578">source</a></section><section><div><pre><code class="language-julia hljs">ne_line(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculates the line averaged density from the equilibrium midplane horizantal line</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L584-L588">source</a></section><section><div><pre><code class="language-julia hljs">ne_line(dd::IMAS.dd; time0::Float64=dd.global_time)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L593-L595">source</a></section><section><div><pre><code class="language-julia hljs">ne_line(ps::IMAS.pulse_schedule; time0=global_time(ps))</code></pre><p>returns n<em>e</em>line from pulse<em>schedule looking first in `pulse</em>schedule.density<em>control.ne</em>line.reference<code>and then</code>pulse<em>schedule.density</em>control.greenwald_fraction.reference`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L600-L604">source</a></section><section><div><pre><code class="language-julia hljs">ne_line(
    equilibrium::IMAS.equilibrium,
    core_profiles::IMAS.core_profiles,
    interferometer::IMAS.interferometer;
    times::Vector{Float64}=equilibrium.time
)</code></pre><p>Calculate time-dependent line average electron density for all interferometer channels.</p><p>Returns new interferometer IDS with synthetic data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/interferometer.jl#L196-L207">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.interferometer!"><a class="docstring-binding" href="#IMAS.interferometer!"><code>IMAS.interferometer!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">interferometer!(
    intf::IMAS.interferometer,
    eqt::IMAS.equilibrium__time_slice,
    cp1d::IMAS.core_profiles__profiles_1d;
    time0::Float64=eqt.time,
    n_points::Int=100
)</code></pre><p>Populate interferometer IDS with synthetic line-averaged and line-integrated electron density measurements for a single time slice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/interferometer.jl#L259-L269">source</a></section><section><div><pre><code class="language-julia hljs">interferometer!(
    intf::IMAS.interferometer,
    eq::IMAS.equilibrium,
    cp::IMAS.core_profiles;
    n_points::Int=100
)</code></pre><p>Populate interferometer IDS with synthetic line-averaged and line-integrated electron density measurements for all time slices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/interferometer.jl#L295-L304">source</a></section></details></article><h2 id="Physics-magnetics"><a class="docs-heading-anchor" href="#Physics-magnetics">Physics magnetics</a><a id="Physics-magnetics-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-magnetics" title="Permalink"></a></h2><h2 id="Physics-neoclassical"><a class="docs-heading-anchor" href="#Physics-neoclassical">Physics neoclassical</a><a id="Physics-neoclassical-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-neoclassical" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.spitzer_conductivity"><a class="docstring-binding" href="#IMAS.spitzer_conductivity"><code>IMAS.spitzer_conductivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">spitzer_conductivity(ne, Te, Zeff)</code></pre><p>Calculates the Spitzer conductivity in [1/(Ω*m)]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L3-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.collision_frequencies"><a class="docstring-binding" href="#IMAS.collision_frequencies"><code>IMAS.collision_frequencies</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">collision_frequencies(cp1d::IMAS.core_profiles__profiles_1d{T}) where {T&lt;:Real}</code></pre><p>Returns named tuple with <code>nue</code>, <code>nui</code>, <code>nu_exch</code> in [1/s]</p><p>NOTE: transpiled from the TGYRO <code>collision_rates</code> subroutine</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L15-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Sauter_neo2021_bootstrap"><a class="docstring-binding" href="#IMAS.Sauter_neo2021_bootstrap"><code>IMAS.Sauter_neo2021_bootstrap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Sauter_neo2021_bootstrap(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d; neo_2021::Bool=true, same_ne_ni::Bool=false)</code></pre><p>Calculates bootstrap current</p><ul><li><p>neo_2021: A.Redl, et al., Phys. Plasma 28, 022502 (2021) instead of O Sauter, et al., Phys. Plasmas 9, 5140 (2002); doi:10.1063/1.1517052 (https://crppwww.epfl.ch/~sauter/neoclassical)</p></li><li><p>same<em>ne</em>ni: assume same inverse scale length for electrons and ions</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L76-L84">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.collisionless_bootstrap_coefficient"><a class="docstring-binding" href="#IMAS.collisionless_bootstrap_coefficient"><code>IMAS.collisionless_bootstrap_coefficient</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">collisionless_bootstrap_coefficient(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Returns the collisional bootstrap coefficient Cbs defines as <code>jbootfract = Cbs * sqrt(ϵ) * βp</code></p><p>See: Gi et al., Fus. Eng. Design 89 2709 (2014)</p><p>See: Wilson et al., Nucl. Fusion 32 257 (1992)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L321-L329">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.nuestar"><a class="docstring-binding" href="#IMAS.nuestar"><code>IMAS.nuestar</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nuestar(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculate the electron collisionality, ν_*e, as a dimensionless measure of the frequency of electron collisions relative to their characteristic transit frequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L340-L345">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.nuistar"><a class="docstring-binding" href="#IMAS.nuistar"><code>IMAS.nuistar</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nuistar(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculate the ion collisionality, ν_*i, as a dimensionless measure of the frequency of ion collisions relative to their characteristic transit frequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L371-L376">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.neo_conductivity"><a class="docstring-binding" href="#IMAS.neo_conductivity"><code>IMAS.neo_conductivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">neo_conductivity(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculates the neo-classical conductivity in 1/(Ohm*meter) based on the NEO 2021 modifcation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L421-L425">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sawtooth_conductivity"><a class="docstring-binding" href="#IMAS.sawtooth_conductivity"><code>IMAS.sawtooth_conductivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sawtooth_conductivity(conductivity::AbstractVector{T}, q::AbstractVector{T}; q_sawtooth::Float64=1.0) where {T&lt;:Real}</code></pre><p>Jardin&#39;s model for stationary sawteeth to raise q&gt;1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L453-L457">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ωtor2sonic"><a class="docstring-binding" href="#IMAS.ωtor2sonic"><code>IMAS.ωtor2sonic</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ωtor2sonic(cp1d::IMAS.core_profiles__profiles_1d; ind::Int=0)</code></pre><p>Populates ExB rotation based on ion omega_tor assuming ωpol=0.0</p><p>Returns the updated <code>cp1d</code> with <code>rotation_frequency_tor_sonic</code> populated and all ion rotation frequencies updated.</p><p><code>ind</code> is the ion species index to use as reference (0 = auto-select first non-zero rotation)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L469-L477">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ωtor2sonic!"><a class="docstring-binding" href="#IMAS.ωtor2sonic!"><code>IMAS.ωtor2sonic!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ωtor2sonic!(cp1d::IMAS.core_profiles__profiles_1d; ind::Int=0)</code></pre><p>Updates <code>cp1d.rotation_frequency_tor_sonic</code> in place based on the specified ion species toroidal rotation, assuming poloidal rotation ωpol=0.0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L495-L499">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sonic2ωtor"><a class="docstring-binding" href="#IMAS.sonic2ωtor"><code>IMAS.sonic2ωtor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sonic2ωtor(cp1d::IMAS.core_profiles__profiles_1d, ion::IMAS.core_profiles__profiles_1d___ion)</code></pre><p>Returns ion ω<em>tor based on ExB rotation assuming ω</em>pol=0.0</p><p>Uses the existing <code>rotation_frequency_tor_sonic</code> field to compute individual ion toroidal rotation frequencies</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L507-L513">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sonic2ωtor!"><a class="docstring-binding" href="#IMAS.sonic2ωtor!"><code>IMAS.sonic2ωtor!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sonic2ωtor!(cp1d::IMAS.core_profiles__profiles_1d, ion::IMAS.core_profiles__profiles_1d___ion)</code></pre><p>In-place conversion of ExB sonic rotation to ion toroidal rotation frequencies.</p><p>Updates individual ion <code>rotation_frequency_tor</code> fields based on the existing ExB sonic rotation, assuming poloidal rotation ωpol=0.0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L525-L531">source</a></section><section><div><pre><code class="language-julia hljs">sonic2ωtor!(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>All ions: Updates rotation frequencies for all ion species in the profile</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/neoclassical.jl#L536-L540">source</a></section></details></article><h2 id="Physics-nuclear"><a class="docs-heading-anchor" href="#Physics-nuclear">Physics nuclear</a><a id="Physics-nuclear-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-nuclear" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.reactivity"><a class="docstring-binding" href="#IMAS.reactivity"><code>IMAS.reactivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">reactivity(Ti::AbstractVector{&lt;:Real}, model::String; polarized_fuel_fraction::Real=0.0)</code></pre><p>Fusion reactivity coming from H.-S. Bosch and G.M. Hale, Nucl. Fusion 32 (1992) 611. Model can be [&quot;D+T→He4&quot;, &quot;D+He3→He4&quot;, &quot;D+D→T&quot;, &quot;D+D→He3&quot;]&quot;)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L10-L15">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_T_to_He4_reactions"><a class="docstring-binding" href="#IMAS.D_T_to_He4_reactions"><code>IMAS.D_T_to_He4_reactions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_T_to_He4_reactions(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculates the number of D-T thermal fusion reactions to He4 in [reactions/m³/s]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L102-L106">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_He3_reactions"><a class="docstring-binding" href="#IMAS.D_D_to_He3_reactions"><code>IMAS.D_D_to_He3_reactions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_He3_reactions(dd::IMAS.dd)</code></pre><p>Calculates the number of D-D thermal fusion reactions to He3 in [reactions/m³/s]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L134-L138">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_T_reactions"><a class="docstring-binding" href="#IMAS.D_D_to_T_reactions"><code>IMAS.D_D_to_T_reactions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_T_reactions(dd::IMAS.dd)</code></pre><p>Calculates the number of D-D thermal fusion reactions to T in [reactions/m³/s]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L164-L168">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fusion_reaction_source"><a class="docstring-binding" href="#IMAS.fusion_reaction_source"><code>IMAS.fusion_reaction_source</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fusion_reaction_source(
    s1d::IMAS.core_sources__source___profiles_1d,
    reactivity::Vector{&lt;:Real},
    in1::Symbol,
    in2::Symbol,
    out::Symbol,
    eV::Float64
)</code></pre><p>Add a fusion reaction source for two isotopes coming in and one coming out</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L197-L208">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_T_to_He4_source!"><a class="docstring-binding" href="#IMAS.D_T_to_He4_source!"><code>IMAS.D_T_to_He4_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_T_to_He4_source!(cs::IMAS.core_sources, cp::IMAS.core_profiles; combine_DT::Bool)</code></pre><p>Calculates DT fusion heating with an estimation of the alpha slowing down to the ions and electrons, modifies dd.core_sources</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L256-L260">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_He3_source!"><a class="docstring-binding" href="#IMAS.D_D_to_He3_source!"><code>IMAS.D_D_to_He3_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_He3_source!(cs::IMAS.core_sources, cp::IMAS.core_profiles)</code></pre><p>Calculates the He-3 heating source from D-D fusion reactions, estimates energy transfer to ions and electrons, modifies dd.core_sources</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L295-L299">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_T_source!"><a class="docstring-binding" href="#IMAS.D_D_to_T_source!"><code>IMAS.D_D_to_T_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_T_source!(cs::IMAS.core_sources, cp::IMAS.core_profiles)</code></pre><p>Calculates the T heating source from D-D fusion reactions, estimates energy transfer to ions and electrons, modifies dd.core_sources</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L329-L333">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_T_to_He4_heating"><a class="docstring-binding" href="#IMAS.D_T_to_He4_heating"><code>IMAS.D_T_to_He4_heating</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_T_to_He4_power(cp1d::IMAS.core_profiles__profiles_1d; polarized_fuel_fraction::Real=0.0)</code></pre><p>Volumetric heating source of He4 particles coming from D-T reactions [W m⁻³]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L383-L387">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_He3_heating"><a class="docstring-binding" href="#IMAS.D_D_to_He3_heating"><code>IMAS.D_D_to_He3_heating</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_He3_power(cp1d::IMAS.core_profiles__profiles_1d; polarized_fuel_fraction::Real=0.0)</code></pre><p>Volumetric heating source of He3 particles coming from D-D reactions [W m⁻³]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L396-L400">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_T_heating"><a class="docstring-binding" href="#IMAS.D_D_to_T_heating"><code>IMAS.D_D_to_T_heating</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_T_power(cp1d::IMAS.core_profiles__profiles_1d; polarized_fuel_fraction::Real=0.0)</code></pre><p>Volumetric heating source of T and H particles coming from D-D reactions [W m⁻³]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L409-L413">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_T_to_He4_plasma_power"><a class="docstring-binding" href="#IMAS.D_T_to_He4_plasma_power"><code>IMAS.D_T_to_He4_plasma_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_T_to_He4_plasma_power(cp1d::IMAS.core_profiles__profiles_1d; polarized_fuel_fraction::Real=0.0)</code></pre><p>Total power in He4 from D-T reaction [W]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L422-L426">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_He3_plasma_power"><a class="docstring-binding" href="#IMAS.D_D_to_He3_plasma_power"><code>IMAS.D_D_to_He3_plasma_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_He3_plasma_power(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Total power in He3 from D-D reaction [W]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L434-L438">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.D_D_to_T_plasma_power"><a class="docstring-binding" href="#IMAS.D_D_to_T_plasma_power"><code>IMAS.D_D_to_T_plasma_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">D_D_to_T_plasma_power(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Total power in T from D-D reaction [W]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L446-L450">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fusion_plasma_power"><a class="docstring-binding" href="#IMAS.fusion_plasma_power"><code>IMAS.fusion_plasma_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fusion_plasma_power(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculates the total fusion power in the plasma in [W]</p><p>If D+T plasma, then D+D is neglected</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L458-L464">source</a></section><section><div><pre><code class="language-julia hljs">fusion_plasma_power(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L478-L480">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fusion_power"><a class="docstring-binding" href="#IMAS.fusion_power"><code>IMAS.fusion_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fusion_power(cp1d::IMAS.core_profiles__profiles_1d{T}; DD_fusion::Bool=false) where {T&lt;:Real}</code></pre><p>Calculates the total fusion power in [W]</p><p>If D+T plasma, then D+D is neglected</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L488-L494">source</a></section><section><div><pre><code class="language-julia hljs">fusion_power(dd::IMAS.dd; DD_fusion::Bool=false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L510-L512">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fusion_energy"><a class="docstring-binding" href="#IMAS.fusion_energy"><code>IMAS.fusion_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fusion_energy(dd::IMAS.dd{T}; DD_fusion::Bool=false) where {T&lt;:Real}</code></pre><p>Fusion energy in [J]: fusion power integrated over simulation time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L520-L524">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fusion_neutron_power"><a class="docstring-binding" href="#IMAS.fusion_neutron_power"><code>IMAS.fusion_neutron_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fusion_neutron_power(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculates the total fusion power in the neutrons [W]</p><p>If D+T plasma, then D+D is neglected</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L534-L540">source</a></section><section><div><pre><code class="language-julia hljs">fusion_neutron_power(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/nuclear.jl#L553-L555">source</a></section></details></article><h2 id="Physics-particles"><a class="docs-heading-anchor" href="#Physics-particles">Physics particles</a><a id="Physics-particles-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-particles" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.Particle"><a class="docstring-binding" href="#IMAS.Particle"><code>IMAS.Particle</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">x::T
y::T
z::T
δvx::T
δvy::T
δvz::T</code></pre><p>Cartesian coordinate system centered in (R=0, Z=0); R = sqrt(X^2 + Y^2) Z = Z</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L9-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Rcoord"><a class="docstring-binding" href="#IMAS.Rcoord"><code>IMAS.Rcoord</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Rcoord(p::Particle)</code></pre><p>Return R coordinate of a Particle</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L50-L54">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-f4e69ccd9b086b82"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-f4e69ccd9b086b82" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.Particle</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.define_particles"><a class="docstring-binding" href="#IMAS.define_particles"><code>IMAS.define_particles</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">define_particles(eqt::IMAS.equilibrium__time_slice, psi_norm::Vector{T}, source_1d::Vector{T}, N::Int; random_seed::Int=0) where {T&lt;:Real}</code></pre><p>Creates a vector of particles from a 1D source (psi<em>norm, source</em>1d) launching N particles.</p><p>Returns also a scalar (I<em>per</em>trace) which is the intensity per trace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L74-L80">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_flux"><a class="docstring-binding" href="#IMAS.find_flux"><code>IMAS.find_flux</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_flux(particles::Vector{Particle{T}}, I_per_trace::T, rwall::Vector{T}, zwall::Vector{T}, dr::T, dz::T; ns::Int=10, debug::Bool=false) where {T&lt;:Real}</code></pre><p>Returns the flux at the wall of the quantity brought by particles, together with a vector of the surface elements on the wall (wall_s)</p><p><code>I_per_trace</code> is the intensity per trace</p><p><code>(rwall, zwall)</code> are the coordinates of the wall</p><p><code>dr</code>, <code>dz</code> are the grid sizes used for the 2d source generation</p><p><code>ns</code> is the window size</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L147-L159">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.toroidal_intersection"><a class="docstring-binding" href="#IMAS.toroidal_intersection"><code>IMAS.toroidal_intersection</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">toroidal_intersection(r1::Real, z1::Real, r2::Real, z2::Real, px::Real, py::Real, pz::Real, vx::Real, vy::Real, vz::Real, v2::Real, vz2::Real)</code></pre><p>Compute the time of intersection between a moving particle and a toroidal surface defined by two points <code>(r1, z1)</code> and <code>(r2, z2)</code>.</p><p>Returns the smallest positive time at which the particle intersects the surface segment. Returns <code>NaN</code> if no valid intersection occurs.</p><ul><li><code>r1</code>, <code>z1</code>: Coordinates of the first endpoint of the toroidal surface segment.</li><li><code>r2</code>, <code>z2</code>: Coordinates of the second endpoint of the toroidal surface segment.</li><li><code>px</code>, <code>py</code>, <code>pz</code>: Current position of the particle in Cartesian coordinates.</li><li><code>vx</code>, <code>vy</code>, <code>vz</code>: Velocity components of the particle.</li><li><code>v2</code>: Squared radial velocity component, <code>vx^2 + vy^2</code>.</li><li><code>vz2</code>: Squared z-velocity component, <code>vz^2</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L304-L317">source</a></section><section><div><pre><code class="language-julia hljs">toroidal_intersections(wallr::Vector{T}, wallz::vector{T}, px::Real, py::Real, pz::Real, vx::Real, vy::Real, vz::Real) where {T&lt;:Real}</code></pre><p>Returns the first time of intersection between a moving particle and a wall in toroidal geometry</p><ul><li><code>wallr</code>: Vector with r coordinates of the wall (must be closed)</li><li><code>wallz</code>: Vector with z coordinates of the wall (must be closed)</li><li><code>px</code>, <code>py</code>, <code>pz</code>: Current position of the particle in Cartesian coordinates.</li><li><code>vx</code>, <code>vy</code>, <code>vz</code>: Velocity components of the particle</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L389-L398">source</a></section><section><div><pre><code class="language-julia hljs">toroidal_intersections(wallr::Vector{T}, wallz::vector{T}, px::Real, py::Real, pz::Real, vx::Real, vy::Real, vz::Real) where {T&lt;:Real}</code></pre><p>Returns first time of intersection between a moving particle and a wall in toroidal geometry</p><ul><li><code>wallr</code>: Vector with r coordinates of the wall (must be closed)</li><li><code>wallz</code>: Vector with z coordinates of the wall (must be closed)</li><li><code>px</code>, <code>py</code>, <code>pz</code>: Current position of the particle in Cartesian coordinates.</li><li><code>pol_angle</code>, <code>tor_angle</code>: poloidal and toroidal angles of injection</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L451-L460">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.toroidal_intersections"><a class="docstring-binding" href="#IMAS.toroidal_intersections"><code>IMAS.toroidal_intersections</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">toroidal_intersections(wallr::Vector{T}, wallz::vector{T}, px::Real, py::Real, pz::Real, vx::Real, vy::Real, vz::Real) where {T&lt;:Real}</code></pre><p>Returns all times of intersection between a moving particle and a wall in toroidal geometry</p><ul><li><code>wallr</code>: Vector with r coordinates of the wall (must be closed)</li><li><code>wallz</code>: Vector with z coordinates of the wall (must be closed)</li><li><code>px</code>, <code>py</code>, <code>pz</code>: Current position of the particle in Cartesian coordinates.</li><li><code>vx</code>, <code>vy</code>, <code>vz</code>: Velocity components of the particle</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L469-L478">source</a></section><section><div><pre><code class="language-julia hljs">toroidal_intersections(wallr::Vector{T}, wallz::vector{T}, px::Real, py::Real, pz::Real, vx::Real, vy::Real, vz::Real) where {T&lt;:Real}</code></pre><p>Returns all times of intersection between a moving particle and a wall in toroidal geometry</p><ul><li><code>wallr</code>: Vector with r coordinates of the wall (must be closed)</li><li><code>wallz</code>: Vector with z coordinates of the wall (must be closed)</li><li><code>px</code>, <code>py</code>, <code>pz</code>: Current position of the particle in Cartesian coordinates.</li><li><code>pol_angle</code>, <code>tor_angle</code>: poloidal and toroidal angles of injection</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L500-L509">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.pol_tor_angles_2_vector"><a class="docstring-binding" href="#IMAS.pol_tor_angles_2_vector"><code>IMAS.pol_tor_angles_2_vector</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pol_tor_angles_2_vector(pol_angle::T, tor_angle::T) where {T&lt;:Real}</code></pre><p>Conversion from toroidal and poloidal angles expressed in radians to unit vector function pol<em>tor</em>angles<em>2</em>vector(pol<em>angle::T, tor</em>angle::T) where {T&lt;:Real} Uses ITER convention for EC launch angles and tor_angle</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L518-L524">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.pencil_beam"><a class="docstring-binding" href="#IMAS.pencil_beam"><code>IMAS.pencil_beam</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pencil_beam(starting_position::Vector{T}, velocity_vector::Vector{T}, time::AbstractVector{Float64})</code></pre><p>returns named tuple with (x, y, z, r) of a beam injected at given (px, py, pz) starting_position with velocity (vx, vy, vz)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L535-L539">source</a></section><section><div><pre><code class="language-julia hljs">pencil_beam(starting_position::Vector{T}, pol_angle::T, tor_angle::T, time::AbstractVector{Float64}) where {T&lt;:Real}</code></pre><p>returns named tuple with (x, y, z, r) of a beam injected at given (px, py, pz) starting_position with given poloidal and toroidal angles</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/particles.jl#L548-L552">source</a></section></details></article><h2 id="Physics-pedestal"><a class="docs-heading-anchor" href="#Physics-pedestal">Physics pedestal</a><a id="Physics-pedestal-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-pedestal" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.blend_core_edge_Hmode"><a class="docstring-binding" href="#IMAS.blend_core_edge_Hmode"><code>IMAS.blend_core_edge_Hmode</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">blend_core_edge_Hmode(
    profile::AbstractVector{&lt;:Real},
    rho::AbstractVector{&lt;:Real},
    ped_height::Real,
    ped_width::Real,
    tr_bound0::Real,
    tr_bound1::Real;
    method::Symbol=:shift)</code></pre><p>Blends the core profiles to the pedestal for H-mode profiles, making sure the Z&#39;s at tr<em>bound0 and tr</em>bound1 match the Z&#39;s from the original profile</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pedestal.jl#L8-L19">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.blend_core_edge_EPED"><a class="docstring-binding" href="#IMAS.blend_core_edge_EPED"><code>IMAS.blend_core_edge_EPED</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">blend_core_edge_EPED(
    profile::AbstractVector{&lt;:Real},
    rho::AbstractVector{&lt;:Real},
    ped_height::Real,
    ped_width::Real,
    nml_bound::Real,
    ped_bound::Real;
    expin::Real,
    expout::Real;
    method::Symbol=:shift)</code></pre><p>Blends the core and pedestal for given profile to match ped<em>height, ped</em>width using nml<em>bound and ped</em>bound as blending boundaries</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pedestal.jl#L79-L92">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.blend_core_edge_Lmode"><a class="docstring-binding" href="#IMAS.blend_core_edge_Lmode"><code>IMAS.blend_core_edge_Lmode</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">blend_core_edge_Lmode(
    profile::AbstractVector{&lt;:Real},
    rho::AbstractVector{&lt;:Real},
    ped_height::Real,
    ped_width::Real,
    tr_bound0::Real,
    tr_bound1::Real)</code></pre><p>Blends the core profiles to the pedestal for L-mode profiles, making sure the Z&#39;s at tr_bound1 matches the Z&#39;s from the original profile</p><p>NOTE: ped<em>width, tr</em>bound0, tr_bound1 are not utilized</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pedestal.jl#L174-L186">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.pedestal_finder"><a class="docstring-binding" href="#IMAS.pedestal_finder"><code>IMAS.pedestal_finder</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pedestal_finder(profile::Vector{T}, psi_norm::Vector{T}; do_plot::Bool=false) where {T&lt;:Real}</code></pre><p>Finds the pedetal height and width using the EPED1 definition.</p><p>NOTE: The width is limited to be between 0.01 and 0.1. If the width is at the 0.1 boundary it is likely an indication that the profile is not a typical H-mode profile. The height is the value of the profile evaluated at (1.0 - width)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pedestal.jl#L233-L241">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ped_height_at_09"><a class="docstring-binding" href="#IMAS.ped_height_at_09"><code>IMAS.ped_height_at_09</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ped_height_at_09(rho::AbstractVector{T}, profile::AbstractVector{T}, height09::T) where {T&lt;:Real}</code></pre><p>Scale density profile so that value at rho=0.9 is height09</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pedestal.jl#L304-L308">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.pedestal_tanh_width_half_maximum"><a class="docstring-binding" href="#IMAS.pedestal_tanh_width_half_maximum"><code>IMAS.pedestal_tanh_width_half_maximum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pedestal_tanh_width_half_maximum(rho::AbstractVector{T}, profile::AbstractVector{T}; rho_pedestal_full_height::Float64=0.9, tanh_width_to_09_factor::Float64=0.85)</code></pre><p>Estimates the tanh-width at half-maximum of a pedestal profile, based on a hyperbolic tangent fit</p><ul><li><code>rho_pedestal_full_height</code>: The normalized flux coordinate at which the pedestal is considered to reach full height.</li><li><code>tanh_width_to_09_factor</code>: Factor to convert the pedestal width at full height (ρ = 0.9) to a hyperbolic tangent profile width.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pedestal.jl#L316-L323">source</a></section></details></article><h2 id="Physics-pf_active"><a class="docs-heading-anchor" href="#Physics-pf_active">Physics pf_active</a><a id="Physics-pf_active-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-pf_active" title="Permalink"></a></h2><div class="admonition is-warning" id="Missing-docstring.-1fa0e2b6785006f2"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-1fa0e2b6785006f2" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.area</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning" id="Missing-docstring.-99f9ea3d8a38f9f"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-99f9ea3d8a38f9f" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.volume</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.is_ohmic_coil"><a class="docstring-binding" href="#IMAS.is_ohmic_coil"><code>IMAS.is_ohmic_coil</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_ohmic_coil(coil::IMAS.pf_active__coil)</code></pre><p>Returns true/false if coil is part of the OH</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pf_active.jl#L39-L43">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.set_coils_function"><a class="docstring-binding" href="#IMAS.set_coils_function"><code>IMAS.set_coils_function</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">set_coils_function(coils::IDSvector{&lt;:IMAS.pf_active__coil}, R0::Float64; force::Bool=false)</code></pre><p>Setup the pf_active.coil[:].function</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/pf_active.jl#L54-L58">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-3645000772ed3ccf"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-3645000772ed3ccf" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.outline</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Physics-profiles"><a class="docs-heading-anchor" href="#Physics-profiles">Physics profiles</a><a id="Physics-profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-profiles" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.pressure_thermal"><a class="docstring-binding" href="#IMAS.pressure_thermal"><code>IMAS.pressure_thermal</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pressure_thermal(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>core_profiles thermal pressure</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L3-L7">source</a></section><section><div><pre><code class="language-julia hljs">pressure_thermal(cp1de::IMAS.core_profiles__profiles_1d___electrons)</code></pre><p>electrons thermal pressure</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L14-L18">source</a></section><section><div><pre><code class="language-julia hljs">pressure_thermal(ion::IMAS.core_profiles__profiles_1d___ion)</code></pre><p>ion thermal pressure</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L23-L27">source</a></section><section><div><pre><code class="language-julia hljs">pressure_thermal(cp1di::IMAS.IDSvector{IMAS.core_profiles__profiles_1d___ion{T}}) where {T&lt;:Real}</code></pre><p>thermal pressure for all ions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L32-L36">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.beta_tor_thermal_norm"><a class="docstring-binding" href="#IMAS.beta_tor_thermal_norm"><code>IMAS.beta_tor_thermal_norm</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">beta_tor_thermal_norm(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Normalized toroidal beta from thermal pressure only, defined as 100 * beta<em>tor</em>thermal * a[m] * B0 [T] / ip [MA]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L51-L55">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.beta_tor_norm"><a class="docstring-binding" href="#IMAS.beta_tor_norm"><code>IMAS.beta_tor_norm</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">beta_tor_norm(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Normalized toroidal beta from total pressure, defined as 100 * beta_tor * a[m] * B0 [T] / ip [MA]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L63-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.beta_tor"><a class="docstring-binding" href="#IMAS.beta_tor"><code>IMAS.beta_tor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">beta_tor(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d; norm::Bool, thermal::Bool)</code></pre><p>Toroidal beta, defined as the volume-averaged total perpendicular pressure divided by (B0^2/(2*mu0)), i.e. beta_toroidal = 2 mu0 int(p dV) / V / B0^2</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L75-L79">source</a></section><section><div><pre><code class="language-julia hljs">beta_tor(pressure_average::Real, Bt::Real)</code></pre><p>Calculates Beta_tor from pressure and Bt</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L630-L634">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.list_ions"><a class="docstring-binding" href="#IMAS.list_ions"><code>IMAS.list_ions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">list_ions(ids1::IDS, idss::Vararg{T}; time0::Float64) where {T&lt;:IDS}</code></pre><p>List of ions mentioned in multiple IDSs at a given time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L177-L181">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ion_element!"><a class="docstring-binding" href="#IMAS.ion_element!"><code>IMAS.ion_element!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ion_element!(
    ion::Union{IMAS.core_profiles__profiles_1d___ion,IMAS.core_sources__source___profiles_1d___ion},
    ion_symbol::Symbol;
    fast::Bool=false)</code></pre><p>Fills the <code>ion.element</code> structure with the a and z_n information, also updates the <code>ion.label</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L194-L201">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ion_properties"><a class="docstring-binding" href="#IMAS.ion_properties"><code>IMAS.ion_properties</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ion_properties( ion_symbol::Symbol; fast::Bool=false)</code></pre><p>Returns named tuple with z_n, a, and label information of a given ion</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L260-L264">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.binding_energy"><a class="docstring-binding" href="#IMAS.binding_energy"><code>IMAS.binding_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">binding_energy(Z::Int, N::Int)</code></pre><p>Return the estimate binding energy in MeV</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L317-L321">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.atomic_mass"><a class="docstring-binding" href="#IMAS.atomic_mass"><code>IMAS.atomic_mass</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">atomic_mass(Z::Int, N::Int)</code></pre><p>Returns the estimated nucleus mass including the estimated effect of binding energy</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L350-L354">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.energy_thermal"><a class="docstring-binding" href="#IMAS.energy_thermal"><code>IMAS.energy_thermal</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">energy_thermal(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Calculates the thermal stored energy</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L375-L379">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.energy_thermal_ped"><a class="docstring-binding" href="#IMAS.energy_thermal_ped"><code>IMAS.energy_thermal_ped</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">energy_thermal_ped(cp1d::IMAS.core_profiles__profiles_1d, su::IMAS.summary)</code></pre><p>Calculates the pedestal contribution to the thermal stored energy by integrating over entire domain but with pedestal pressure in the core</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L387-L391">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.tau_e_thermal"><a class="docstring-binding" href="#IMAS.tau_e_thermal"><code>IMAS.tau_e_thermal</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">tau_e_thermal(cp1d::IMAS.core_profiles__profiles_1d, sources::IMAS.core_sources; , include_radiation::Bool=true, include_time_derivative::Bool=true</code></pre><p>Evaluate thermal energy confinement time</p><p>NOTE: This can go to infinity if there&#39;s more power coming out of the plasma than there is going in</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L402-L408">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.tau_e_h98"><a class="docstring-binding" href="#IMAS.tau_e_h98"><code>IMAS.tau_e_h98</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">tau_e_h98(dd::IMAS.dd; time0::Float64=dd.global_time, include_radiation::Bool=true, include_time_derivative::Bool=true)</code></pre><p>H98y2 ITER elmy H-mode confinement time scaling</p><p>NOTE: H98y2 uses aereal elongation</p><p>NOTE: (IPB<em>Chap</em>2.pdf, pg. 72) ...for practical reasons, the power lost by radiation inside the separatrix of the existing devices has been neglected when deriving the scalings. However, for ITER, such radiation is subtracted from the loss power when calculating the projected energy confinement time.</p><p>See Table 5 in https://iopscience.iop.org/article/10.1088/0029-5515/39/12/302/pdf and https://iopscience.iop.org/article/10.1088/0029-5515/48/9/099801/pdf for additional correction with plasma_volume</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L420-L433">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.tau_e_ds03"><a class="docstring-binding" href="#IMAS.tau_e_ds03"><code>IMAS.tau_e_ds03</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">tau_e_ds03(dd::IMAS.dd; time0::Float64=dd.global_time, include_radiation::Bool=true, include_time_derivative::Bool=true)</code></pre><p>Petty&#39;s 2003 confinement time scaling</p><p>NOTE: Petty uses elongation at the separatrix and makes no distinction between volume and line-average density</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L469-L475">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.greenwald_density"><a class="docstring-binding" href="#IMAS.greenwald_density"><code>IMAS.greenwald_density</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">greenwald_density(eqt::IMAS.equilibrium__time_slice)</code></pre><p>Simple greenwald line-averaged density limit</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L511-L515">source</a></section><section><div><pre><code class="language-julia hljs">greenwald_density(ip::T, minor_radius::T) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L520-L522">source</a></section><section><div><pre><code class="language-julia hljs">greenwald_density(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L527-L529">source</a></section><section><div><pre><code class="language-julia hljs">greenwald_density(ps::IMAS.pulse_schedule; time0=global_time(ps))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L534-L536">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.greenwald_fraction"><a class="docstring-binding" href="#IMAS.greenwald_fraction"><code>IMAS.greenwald_fraction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">greenwald_fraction(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Greewald fraction</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L546-L550">source</a></section><section><div><pre><code class="language-julia hljs">greenwald_fraction(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L557-L559">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-2f9d04f3e8b328d5"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-2f9d04f3e8b328d5" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.ne_line</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.ne_vol_avg"><a class="docstring-binding" href="#IMAS.ne_vol_avg"><code>IMAS.ne_vol_avg</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ne_vol_avg(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Volume averaged electron density</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L618-L622">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-f9a94ca1169195a6"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-f9a94ca1169195a6" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.beta_tor</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.beta_n"><a class="docstring-binding" href="#IMAS.beta_n"><code>IMAS.beta_n</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">beta_n(beta_tor::Real, minor_radius::Real, Bt::Real, Ip::Real)</code></pre><p>Calculates BetaN from beta_tor</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L642-L646">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.pressure_avg_from_beta_n"><a class="docstring-binding" href="#IMAS.pressure_avg_from_beta_n"><code>IMAS.pressure_avg_from_beta_n</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pressure_avg_from_beta_n(beta_n::Real, minor_radius::Real, Bt::Real, Ip::Real)</code></pre><p>Calculates average pressure from BetaN</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L654-L658">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Hmode_profiles"><a class="docstring-binding" href="#IMAS.Hmode_profiles"><code>IMAS.Hmode_profiles</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Hmode_profiles(edge::Real, ped::Real, core::Real, ngrid::Int, expin::Real, expout::Real, width::Real; offset::Real=0.0)</code></pre><p>Generate H-mode density and temperature profiles evenly spaced in the radial coordinate</p><ul><li><code>edge</code>: separatrix value</li><li><code>ped</code>: pedestal value</li><li><code>core</code>: on-axis value</li><li><code>ngrid</code>: number of radial grid points</li><li><code>expin</code>: inner core exponent for H-mode pedestal profile</li><li><code>expout</code>: outer core exponent for H-mode pedestal profile</li><li><code>width</code>: full width of pedestal (from the separatrix to the pedestal itself)</li><li><code>offset</code>: offset of the pedestal center</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L666-L679">source</a></section><section><div><pre><code class="language-julia hljs">Hmode_profiles(edge::T, ped::T, ngrid::Int, expin::T, expout::T, width::T) where {T&lt;:Real}</code></pre><p>NOTE: The core value is allowed to float</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L711-L715">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Lmode_profiles"><a class="docstring-binding" href="#IMAS.Lmode_profiles"><code>IMAS.Lmode_profiles</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Lmode_profiles(edge::Real, ped::Real, core::Real, ngrid::Int, expin::Real, expout::Real, width::Real)</code></pre><p>Generate L-mode density and temperature profiles evenly spaced in the radial coordinate</p><ul><li><code>edge</code>: separatrix value</li><li><code>ped</code>: pedestal value</li><li><code>ngrid</code>: number of radial grid points</li><li><code>expin</code>: inner core exponent for H-mode pedestal profile</li><li><code>expout</code>: outer core exponent for H-mode pedestal profile</li><li><code>width</code>: width of pedestal</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L754-L765">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.A_effective"><a class="docstring-binding" href="#IMAS.A_effective"><code>IMAS.A_effective</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">A_effective(cp1d::IMAS.core_profiles__profiles_1d{T}) where {T&lt;:Real}</code></pre><p>A_effective towards L to H scaling see: G. Birkenmeier et al 2022 Nucl. Fusion 62 086005</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L784-L788">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.scaling_L_to_H_power"><a class="docstring-binding" href="#IMAS.scaling_L_to_H_power"><code>IMAS.scaling_L_to_H_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">scaling_L_to_H_power(cp1d::IMAS.core_profiles__profiles_1d, eqt::IMAS.equilibrium__time_slice; metallic_wall:Bool=true)</code></pre><p>L to H transition power threshold for metal walls and isotope effect according to: G. Birkenmeier et al 2022 Nucl. Fusion 62 086005</p><p>See also: <code>Reducing the L-H Transition Power Threshold in DIII-D ITER-Similar-Shape Hydrogen Plasmas, L. Schmitz IAEA FEC 2020</code></p><p>NOTE: This scaling does not reflect a well documented nonmonotonic density dependence.</p><p>L<em>H</em>threshold doubles when ion ∇B drift is away from X-point</p><p>returns Infinity if the plasma is diverted or in negative triangularity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L806-L818">source</a></section><section><div><pre><code class="language-julia hljs">scaling_L_to_H_power(dd::IMAS.dd; time0::Float64=dd.global_time)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L870-L872">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.L_H_threshold"><a class="docstring-binding" href="#IMAS.L_H_threshold"><code>IMAS.L_H_threshold</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">L_H_threshold(cs::IMAS.core_sources, cp1d::IMAS.core_profiles__profiles_1d, eqt::IMAS.equilibrium__time_slice; time0::Float64=dd.global_time)</code></pre><p>Returns ratio of Psol to Plh</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L880-L884">source</a></section><section><div><pre><code class="language-julia hljs">L_H_threshold(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L891-L893">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.satisfies_h_mode_conditions"><a class="docstring-binding" href="#IMAS.satisfies_h_mode_conditions"><code>IMAS.satisfies_h_mode_conditions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">satisfies_h_mode_conditions(dd::IMAS.dd; threshold_multiplier::Float64=1.0)</code></pre><p>Returns <code>true</code> if the plasma is diverted, has positive triangularity, and <code>Psol &gt; Plh * threshold_multiplier</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L901-L905">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ITB"><a class="docstring-binding" href="#IMAS.ITB"><code>IMAS.ITB</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ITB(rho0::T, width::T, height::T, rho::AbstractVector{T}) where {T&lt;:Real}</code></pre><p>tanh profile to be added to existing profiles to model Internal Transport Barrier (ITB). The ITB is centered at <code>rho0</code>, with a full width of <code>width</code> and given <code>height</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L918-L923">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ITB_profile"><a class="docstring-binding" href="#IMAS.ITB_profile"><code>IMAS.ITB_profile</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ITB_profile(rho::AbstractVector{T}, input_profile::AbstractVector{T}, rho0::T, width::T, height_ratio::T) where {T&lt;:Real}</code></pre><p>Add ITB to existing profile. The ITB is centered at <code>rho0</code>, with a full width of <code>width</code>, and a height expressed as a ratio of the input_profile evaluated on axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L931-L935">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.species"><a class="docstring-binding" href="#IMAS.species"><code>IMAS.species</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">species(cp1d::IMAS.core_profiles__profiles_1d; only_electrons_ions::Symbol=:all, only_thermal_fast::Symbol=:all, return_zero_densities::Bool=false)</code></pre><p>Returns species index and names (followed by &quot;<em>fast&quot; if density</em>fast is present), for example:</p><pre><code class="language-julia hljs">(0, :electrons)
(0, :electrons_fast)
(1, :DT)
(2, :Kr83)
(3, :He4)
(1, :DT_fast)
(3, :He4_fast)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L945-L957">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.is_quasi_neutral"><a class="docstring-binding" href="#IMAS.is_quasi_neutral"><code>IMAS.is_quasi_neutral</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">is_quasi_neutral(cp1d::IMAS.core_profiles__profiles_1d; rtol::Float64=0.001)</code></pre><p>Returns true if quasi neutrality is satisfied within a relative tolerance</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L996-L1000">source</a></section><section><div><pre><code class="language-julia hljs">is_quasi_neutral(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1011-L1013">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.enforce_quasi_neutrality!"><a class="docstring-binding" href="#IMAS.enforce_quasi_neutrality!"><code>IMAS.enforce_quasi_neutrality!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">enforce_quasi_neutrality!(cp1d::IMAS.core_profiles__profiles_1d, species::Symbol)</code></pre><p>If <code>species</code> is <code>:electrons</code> then updates <code>electrons.density_thermal</code> to meet quasi neutrality condtion.</p><p>If <code>species</code> is a ion species, it evaluates the difference in number of charges needed to reach quasi-neutrality, and assigns positive difference to target ion density<em>thermal species and negative difference to electrons density</em>thermal</p><p>Also, sets <code>density</code> to the original expression</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1021-L1029">source</a></section><section><div><pre><code class="language-julia hljs">enforce_quasi_neutrality!(dd::IMAS.dd, species::Symbol)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1073-L1075">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.lump_ions_as_bulk_and_impurity"><a class="docstring-binding" href="#IMAS.lump_ions_as_bulk_and_impurity"><code>IMAS.lump_ions_as_bulk_and_impurity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">lump_ions_as_bulk_and_impurity(ions::IMAS.IDSvector{&lt;:IMAS.core_profiles__profiles_1d___ion}, rho_tor_norm::Vector{&lt;:Real})</code></pre><p>Changes core_profiles.ion to 2 species, one bulk species (H, D, T) and one combined impurity species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1083-L1087">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.unbundle_DT!"><a class="docstring-binding" href="#IMAS.unbundle_DT!"><code>IMAS.unbundle_DT!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">unbundle_DT!(cp1d::IMAS.core_profiles__profiles_1d; dt_fraction::Real=0.5)</code></pre><p>Split DT ion species into separate D and T species.</p><p>Finds ion species labeled &quot;DT&quot; and splits them into separate &quot;D&quot; and &quot;T&quot; species.</p><p>The densities, pressures, and other quantities are distributed according to dt_fraction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1169-L1177">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.bundle_DT!"><a class="docstring-binding" href="#IMAS.bundle_DT!"><code>IMAS.bundle_DT!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">bundle_DT!(cp1d::IMAS.core_profiles__profiles_1d; d_label::String=&quot;D&quot;, t_label::String=&quot;T&quot;)</code></pre><p>Combine separate D and T ion species into a single DT species.</p><p>Finds &quot;D&quot; and &quot;T&quot; ion species and combines them into a single &quot;DT&quot; species.</p><p>Densities and pressures are summed, temperatures are density-weighted averaged.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1259-L1267">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.new_impurity_fraction!"><a class="docstring-binding" href="#IMAS.new_impurity_fraction!"><code>IMAS.new_impurity_fraction!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">new_impurity_fraction!(cp1d::IMAS.core_profiles__profiles_1d, impurity_name::Symbol, impurity_ne_fraction::Real)</code></pre><p>Add thermal impurity to core_profiles given impurity fraction.</p><p>The new impurity will have the same density profile shape as the electron density profile and the same ion temperature as the main ion specie.</p><p>The main ion specie will be adjusted to have quasineutrality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1402-L1410">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.new_impurity_radiation!"><a class="docstring-binding" href="#IMAS.new_impurity_radiation!"><code>IMAS.new_impurity_radiation!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">new_impurity_radiation!(dd::IMAS.dd, impurity_name::Symbol, total_radiated_power::Real)</code></pre><p>Add thermal impurity to core_profiles to match a total radiated power.</p><p>The new impurity will have the same density profile shape as the electron density profile and the same ion temperature as the main ion specie.</p><p>The main ion specie will be adjusted to have quasineutrality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1436-L1444">source</a></section><section><div><pre><code class="language-julia hljs">new_impurity_radiation!(dd::IMAS.dd, impurity_name::Symbol, time_total_radiated_power::AbstractVector{Float64}, value_total_radiated_power::AbstractVector{&lt;:Real})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1462-L1464">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.zeff"><a class="docstring-binding" href="#IMAS.zeff"><code>IMAS.zeff</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">zeff(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Returns plasma effective charge</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1490-L1494">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.avgZ"><a class="docstring-binding" href="#IMAS.avgZ"><code>IMAS.avgZ</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">avgZ(Z::Real, Ti::T) where {T&lt;:Real}</code></pre><p>Returns average ionization state of an ion at a given temperature</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1538-L1542">source</a></section><section><div><pre><code class="language-julia hljs">avgZ(ion::core_profiles__profiles_1d___ion)</code></pre><p>Returns average ionization state profile of an ion</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1563-L1567">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.t_i_average"><a class="docstring-binding" href="#IMAS.t_i_average"><code>IMAS.t_i_average</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">t_i_average(cp1d::IMAS.core_profiles__profiles_1d)::Vector{&lt;:Real}</code></pre><p>Returns the average ion temperature weighted by each species density over the total number of ion particles</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1584-L1588">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-5aa9dfbc46b80492"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-5aa9dfbc46b80492" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.edge_profile</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.core_edge_energy"><a class="docstring-binding" href="#IMAS.core_edge_energy"><code>IMAS.core_edge_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">core_edge_energy(cp1d::IMAS.core_profiles__profiles_1d, rho_ped::Real; thermal::Bool=true)</code></pre><p>Evaluate stored energy in the core (&lt; rho<em>ped) or the pedestal (&gt; rho</em>ped)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1630-L1634">source</a></section><section><div><pre><code class="language-julia hljs">core_edge_energy(eqt::IMAS.equilibrium__time_slice, rho_ped::Real)</code></pre><p>Evaluate stored energy in the core (&lt; rho<em>ped) or the pedestal (&gt; rho</em>ped)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1644-L1648">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.scale_ion_densities_to_target_zeff"><a class="docstring-binding" href="#IMAS.scale_ion_densities_to_target_zeff"><code>IMAS.scale_ion_densities_to_target_zeff</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">scale_ion_densities_to_target_zeff(cp1d::IMAS.core_profiles__profiles_1d{T}, rho_scale::Real, target_zeff::Real) where {T&lt;:Real}</code></pre><p>Returns scale coefficients for main ions and impurity density profiles needed to achieve a target zeff at a specific radial location</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1667-L1671">source</a></section><section><div><pre><code class="language-julia hljs">scale_ion_densities_to_target_zeff(cp1d::IMAS.core_profiles__profiles_1d{T}, target_zeff::Vector{T}) where {T&lt;:Real}</code></pre><p>Returns scale coefficients for main ions and impurity density profiles needed to achieve a target zeff profile</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1710-L1714">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.scale_ion_densities_to_target_zeff!"><a class="docstring-binding" href="#IMAS.scale_ion_densities_to_target_zeff!"><code>IMAS.scale_ion_densities_to_target_zeff!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">scale_ion_densities_to_target_zeff!(cp1d::IMAS.core_profiles__profiles_1d{T}, rho_scale::Real, target_zeff::Real) where {T&lt;:Real}</code></pre><p>Scale main ions and impurity density profiles in place to achieve a target zeff at a specific radial location</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1755-L1759">source</a></section><section><div><pre><code class="language-julia hljs">scale_ion_densities_to_target_zeff!(cp1d::IMAS.core_profiles__profiles_1d{T}, target_zeff::Vector{T}) where {T&lt;:Real}</code></pre><p>Scale main ions and impurity density profiles in place to achieve a target zeff profile</p><p>NOTE: this function also enforces quasi-neutrality</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/profiles.jl#L1775-L1781">source</a></section></details></article><h2 id="Physics-radiation"><a class="docs-heading-anchor" href="#Physics-radiation">Physics radiation</a><a id="Physics-radiation-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-radiation" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.radiation_losses"><a class="docstring-binding" href="#IMAS.radiation_losses"><code>IMAS.radiation_losses</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">radiation_losses(sources::IMAS.core_sources)</code></pre><p>Evaluate total plasma radiation losses [W] due to bremsstrahlung, synchrotron, and line radiation</p><p>These are energy losses, so they have a negative sign.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/radiation.jl#L3-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.bremsstrahlung_source!"><a class="docstring-binding" href="#IMAS.bremsstrahlung_source!"><code>IMAS.bremsstrahlung_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">bremsstrahlung_source!(dd::IMAS.dd)</code></pre><p>Calculates approximate NRL Bremsstrahlung radiation source and modifies dd.core_sources</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/radiation.jl#L26-L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.rad_sync"><a class="docstring-binding" href="#IMAS.rad_sync"><code>IMAS.rad_sync</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rad_sync(ϵ::T, a::T, B0::T, ne::T, Te::T; wall_reflection_coefficient) where {T&lt;:Real}</code></pre><p>Synchrotron radiation from Trubnikov, JETP Lett. 16 (1972) 25.0</p><p>Transpiled from gacode/tgyro/src/tgyro_rad.f90</p><p>See also: Study of heat and synchrotron radiation transport in fusion tokamak plasmas (C. Villar 1997)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/radiation.jl#L46-L54">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.synchrotron_source!"><a class="docstring-binding" href="#IMAS.synchrotron_source!"><code>IMAS.synchrotron_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">synchrotron_source!(dd::IMAS.dd; wall_reflection_coefficient=0.0)</code></pre><p>Calculates synchrotron radiation source and modifies dd.core_sources</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/radiation.jl#L78-L82">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.line_radiation_source!"><a class="docstring-binding" href="#IMAS.line_radiation_source!"><code>IMAS.line_radiation_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">line_radiation_source!(dd::IMAS.dd)</code></pre><p>Calculates line radiation sources and modifies dd.core_sources</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/radiation.jl#L106-L110">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.adas21"><a class="docstring-binding" href="#IMAS.adas21"><code>IMAS.adas21</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">adas21(Te, name)</code></pre><p>NOTE: Te in [keV] and output is in <code>[erg / cm^3 / s]</code></p><p>12-term Chebyshev polynomial fits to ADAS data</p><pre><code class="language-julia hljs">ln[ Lz(x) ] = sum c_n T_n(x)</code></pre><p>where</p><pre><code class="language-julia hljs">Lz = cooling rate in erg/cm^3/s

T_n(x) = cos[n*arccos(x)] (Chebyshev polynomials)

T = electron temperature

             ln(T/T_min)
x = -1 + 2 --------------- 
           ln(T_max/T_min)

c_n = tabulated polynomial coefficients for each ion</code></pre><p>Acknowledgements:</p><ul><li>F. Sciortino for providing access to ADAS data via Aurora</li><li>T. Pütterich for up-to-data ADAS data</li><li>T. Odstrčil for help/checking of 2025 updates</li></ul><p>References:</p><ul><li>Open ADAS: https://open.adas.ac.uk</li><li>T. Pütterich et al 2019 Nucl. Fusion 59 056013</li></ul><p>Notes:</p><ul><li>Lz = Lz<em>line + Lz</em>continuum</li><li>Aurora follows the radiation nomenclature of ADAS (as described here), separating &quot;line&quot; and &quot;continuum&quot; radiation. Line radiation basically comes from ADF11 PLT files and continuum radiation comes from ADF11 PRB files. Bremsstrahlung is included in the continuum term.</li><li>For generation of fit coefficients, see tgyro/tools/radiation    # Min and max values of Te</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/radiation.jl#L157-L199">source</a></section></details></article><h2 id="Physics-sol"><a class="docs-heading-anchor" href="#Physics-sol">Physics sol</a><a id="Physics-sol-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-sol" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.OpenFieldLine"><a class="docstring-binding" href="#IMAS.OpenFieldLine"><code>IMAS.OpenFieldLine</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">r::Vector{Float64}
z::Vector{Float64}
Br::Vector{Float64}
Bz::Vector{Float64}
Bp::Vector{Float64}
Bt::Vector{Float64}
pitch::Vector{Float64}
s::Vector{Float64}
midplane_index::Int
strike_angles::Vector{Float64}           # Angle in radiants between flux surface and the wall; poloidal angle
pitch_angles::Vector{Float64}            # Angle in radiants between B and Btoroidal; atan(Bp/Bt)
grazing_angles::Vector{Float64}          # Angle in radiants between B and the wall; grazing angle
total_flux_expansion::Vector{Float64}    # Total flux expansion
poloidal_flux_expansion::Vector{Float64} # Poloidal flux expansion
wall_index::Vector{Int}                  # index in dd.wall where strike points intersect</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L3-L19">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sol"><a class="docstring-binding" href="#IMAS.sol"><code>IMAS.sol</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sol(eqt::IMAS.equilibrium__time_slice, wall_r::AbstractVector{T}, wall_z::AbstractVector{T}; levels::Union{Int,AbstractVector}=20, use_wall::Bool=true) where {T&lt;:Real}</code></pre><p>Returns vectors of hfs and lfs OpenFieldLine</p><p>If levels is a vector, it has the values of psi from 0 to max psi<em>wall</em>midplane. The function will modify levels of psi to introduce relevant sol surfaces</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L166-L172">source</a></section><section><div><pre><code class="language-julia hljs">sol(eqt::IMAS.equilibrium__time_slice, wall::IMAS.wall; levels::Union{Int,AbstractVector}=20, use_wall::Bool=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L311-L313">source</a></section><section><div><pre><code class="language-julia hljs">sol(dd::IMAS.dd; levels::Union{Int,AbstractVector}=20, use_wall::Bool=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L319-L321">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_levels_from_P"><a class="docstring-binding" href="#IMAS.find_levels_from_P"><code>IMAS.find_levels_from_P</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_levels_from_P(
    eqt::IMAS.equilibrium__time_slice,
    wall_r::AbstractVector{&lt;:Real},
    wall_z::AbstractVector{&lt;:Real},
    PSI_interpolant::Interpolations.AbstractInterpolation,
    r::Vector{&lt;:Real},
    q::Vector{&lt;:Real},
    levels::Int
)</code></pre><p>Function for the discretization of the poloidal flux ψ on the SOL, based on an hypotesis of OMP radial transport through arbitrary q(r) returns vector with level of ψ, vector with matching r<em>midplane and q. Discretization with even steps of P = integral</em>sep^wal 2πrq(r)dr (same power in each flux tube)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L329-L343">source</a></section><section><div><pre><code class="language-julia hljs">find_levels_from_P(
    eqt::IMAS.equilibrium__time_slice,
    wall::IMAS.wall,
    PSI_interpolant::Interpolations.AbstractInterpolation,
    r::Vector{&lt;:Real},
    q::Vector{&lt;:Real},
    levels::Int
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L533-L542">source</a></section><section><div><pre><code class="language-julia hljs">find_levels_from_P(dd::IMAS.dd, r::Vector{&lt;:Real}, q::Vector{&lt;:Real}, levels::Int)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L554-L556">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_levels_from_wall"><a class="docstring-binding" href="#IMAS.find_levels_from_wall"><code>IMAS.find_levels_from_wall</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_levels_from_wall(
    eqt::IMAS.equilibrium__time_slice,
    wall_r::AbstractVector{&lt;:Real},
    wall_z::AbstractVector{&lt;:Real},
    PSI_interpolant::Interpolations.AbstractInterpolation
)</code></pre><p>Function for that computes the value of psi at the points of the wall mesh in dd</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L565-L574">source</a></section><section><div><pre><code class="language-julia hljs">find_levels_from_wall(eqt::IMAS.equilibrium__time_slice, wall::IMAS.wall, PSI_interpolant::Interpolations.AbstractInterpolation)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L602-L604">source</a></section><section><div><pre><code class="language-julia hljs">find_levels_from_wall(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L609-L611">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.line_wall_2_wall"><a class="docstring-binding" href="#IMAS.line_wall_2_wall"><code>IMAS.line_wall_2_wall</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">line_wall_2_wall(r::AbstractVector{T}, z::AbstractVector{T}, wall_r::AbstractVector{T}, wall_z::AbstractVector{T}, RA::Real, ZA::Real) where {T&lt;:Real}</code></pre><p>Returns r, z coordinates of open field line contained within wall, as well as angles of incidence at the strike locations</p><p>RA and ZA are the coordinate of the magnetic axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L620-L626">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.identify_strike_surface"><a class="docstring-binding" href="#IMAS.identify_strike_surface"><code>IMAS.identify_strike_surface</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">identify_strike_surface(ofl::OpenFieldLine, divertors::IMAS.divertors)</code></pre><p>Returns vector of two tuples with three integers each, identifying the indexes of the divertor/target/tile that the field line intersections</p><p>When a field line does not intersect a divertor target, then the tuple returned is (0, 0, 0)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L757-L763">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.divertor_totals_from_targets!"><a class="docstring-binding" href="#IMAS.divertor_totals_from_targets!"><code>IMAS.divertor_totals_from_targets!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">divertor_totals_from_targets!(divertor::IMAS.divertors__divertor)</code></pre><p>Sets total values of properties by summing over the corresponding value on the targets</p><ul><li>power<em>black</em>body</li><li>power_conducted</li><li>power_convected</li><li>power_currents</li><li>power_incident</li><li>power_neutrals</li><li>power_radiated</li><li>power<em>recombination</em>neutrals</li><li>power<em>recombination</em>plasma</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L791-L805">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Bpol"><a class="docstring-binding" href="#IMAS.Bpol"><code>IMAS.Bpol</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Bpol(a::T, κ::T, Ip::T) where {T&lt;:Real}</code></pre><p>Average poloidal magnetic field magnitude</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L835-L839">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.Bpol_omp"><a class="docstring-binding" href="#IMAS.Bpol_omp"><code>IMAS.Bpol_omp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Bpol_omp(eqt::IMAS.equilibrium__time_slice)</code></pre><p>Poloidal magnetic field magnitude evaluated at the outer midplane</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L847-L851">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.power_sol"><a class="docstring-binding" href="#IMAS.power_sol"><code>IMAS.power_sol</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">power_sol(core_sources::IMAS.core_sources, cp1d::IMAS.core_profiles__profiles_1d; time0::Float64=global_time(cp1d))</code></pre><p>Total power coming out of the SOL [W]</p><p>NOTE: This function returns 1.0 [W] if power is less than that so that SOL quantities remain finite</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L863-L869">source</a></section><section><div><pre><code class="language-julia hljs">power_sol(dd::IMAS.dd; time0::Float64=dd.global_time)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L876-L878">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.widthSOL_loarte"><a class="docstring-binding" href="#IMAS.widthSOL_loarte"><code>IMAS.widthSOL_loarte</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">widthSOL_loarte(B0::T, q95::T, Psol::T) where {T&lt;:Real}</code></pre><p>Returns midplane power decay length λ_q in meters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L889-L893">source</a></section><section><div><pre><code class="language-julia hljs">widthSOL_loarte(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d, core_sources::IMAS.core_sources)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L898-L900">source</a></section><section><div><pre><code class="language-julia hljs">widthSOL_loarte(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L908-L910">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.widthSOL_sieglin"><a class="docstring-binding" href="#IMAS.widthSOL_sieglin"><code>IMAS.widthSOL_sieglin</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">widthSOL_sieglin(R0::T, a::T, Bpol_omp::T, Psol::T, ne_ped::T) where {T&lt;:Real}</code></pre><p>Returns integral power decay length λ_int in meters Eich scaling(NF 53 093031) &amp; B. Sieglin PPCF 55 (2013) 124039</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L921-L926">source</a></section><section><div><pre><code class="language-julia hljs">widthSOL_sieglin(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d, core_sources::IMAS.core_sources)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L947-L949">source</a></section><section><div><pre><code class="language-julia hljs">widthSOL_sieglin(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L959-L961">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.widthSOL_eich"><a class="docstring-binding" href="#IMAS.widthSOL_eich"><code>IMAS.widthSOL_eich</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">widthSOL_eich(R0::T, a::T, Bpol_omp::T, Psol::T) where {T&lt;:Real}</code></pre><p>Returns midplane power decay length λ_q in meters</p><p>Eich scaling (NF 53 093031)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L972-L978">source</a></section><section><div><pre><code class="language-julia hljs">widthSOL_eich(eqt::IMAS.equilibrium__time_slice, Psol::Real)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L983-L985">source</a></section><section><div><pre><code class="language-julia hljs">widthSOL_eich(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d, core_sources::IMAS.core_sources)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L993-L995">source</a></section><section><div><pre><code class="language-julia hljs">widthSOL_eich(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1001-L1003">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.q_pol_omp_eich"><a class="docstring-binding" href="#IMAS.q_pol_omp_eich"><code>IMAS.q_pol_omp_eich</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_pol_omp_eich(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d, core_sources::IMAS.core_sources)</code></pre><p>Poloidal heat flux [W/m²] at the outer midplane based on Eich λ_q</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1011-L1015">source</a></section><section><div><pre><code class="language-julia hljs">q_pol_omp_eich(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1024-L1026">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.q_par_omp_eich"><a class="docstring-binding" href="#IMAS.q_par_omp_eich"><code>IMAS.q_par_omp_eich</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_par_omp_eich(eqt::IMAS.equilibrium__time_slice, cp1d::IMAS.core_profiles__profiles_1d, core_sources::IMAS.core_sources)</code></pre><p>Parallel heat flux [W/m²] at the outer midplane based on Eich λ_q</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1034-L1038">source</a></section><section><div><pre><code class="language-julia hljs">q_par_omp_eich(dd::IMAS.dd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1047-L1049">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-e9eec4f43aee90a"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-e9eec4f43aee90a" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.q_par_omp_eich</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.find_strike_points"><a class="docstring-binding" href="#IMAS.find_strike_points"><code>IMAS.find_strike_points</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_strike_points(pr::AbstractVector{T1}, pz::AbstractVector{T1}, wall_r::AbstractVector{T2}, wall_z::AbstractVector{T2}) where {T1&lt;:Real, T2&lt;:Real}Real}</code></pre><p>Finds strike points and angles of incidence between two paths</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1090-L1094">source</a></section><section><div><pre><code class="language-julia hljs">find_strike_points(
    eqt::IMAS.equilibrium__time_slice{T1},
    wall_r::AbstractVector{T2},
    wall_z::AbstractVector{T2},
    psi_last_closed::Real,
    psi_first_open::Real;
    strike_surfaces_r::AbstractVector{T3}=wall_r,
    strike_surfaces_z::AbstractVector{T3}=wall_z,
    private_flux_regions::Bool=true
) where {T1&lt;:Real,T2&lt;:Real,T3&lt;:Real}</code></pre><p>Finds equilibrium strike points, angle of incidence between wall and strike leg, and the minimum distance between the surface where a strike point is located (both private and encircling) and the last closed flux surface (encircling)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1102-L1116">source</a></section><section><div><pre><code class="language-julia hljs">find_strike_points(
    eqt::IMAS.equilibrium__time_slice{T1},
    wall_r::AbstractVector{T2},
    wall_z::AbstractVector{T2},
    psi_last_closed::Real,
    psi_first_open::Real,
    dv::IMAS.divertors{T1};
    private_flux_regions::Bool=true
) where {T1&lt;:Real,T2&lt;:Real}</code></pre><p>Return strike points location in the divertors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1277-L1289">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.find_strike_points!"><a class="docstring-binding" href="#IMAS.find_strike_points!"><code>IMAS.find_strike_points!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_strike_points!(
    eqt::IMAS.equilibrium__time_slice{T1},
    wall_r::AbstractVector{T2},
    wall_z::AbstractVector{T2},
    psi_last_closed::Real,
    psi_first_open::Real,
    dv::IMAS.divertors{T1};
    private_flux_regions::Bool=true,
    in_place::Bool=true
) where {T1&lt;:Real,T2&lt;:Real}</code></pre><p>Adds strike points location to equilibrium IDS</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1214-L1227">source</a></section><section><div><pre><code class="language-julia hljs">find_strike_points!(
    eqt::IMAS.equilibrium__time_slice{T1},
    wall_r::AbstractVector{T2},
    wall_z::AbstractVector{T2},
    psi_last_closed::Real,
    psi_first_open::Real
) where {T1&lt;:Real,T2&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sol.jl#L1303-L1311">source</a></section></details></article><h2 id="Physics-sources"><a class="docs-heading-anchor" href="#Physics-sources">Physics sources</a><a id="Physics-sources-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-sources" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.fusion_source!"><a class="docstring-binding" href="#IMAS.fusion_source!"><code>IMAS.fusion_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fusion_source!(cs::IMAS.core_sources, cp::IMAS.core_profiles; DD_fusion::Bool=false)</code></pre><p>Calculates fusion source from D-T and D-D reactions and adds them to <code>dd.core_sources</code></p><p>If D+T plasma, then D+D is neglected</p><p>If D+D plasma fusion is included depending on <code>DD_fusion</code> switch</p><p>NOTE: if found, it removes :fusion source that were not generated by FUSE, to avoid double counting</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L3-L13">source</a></section><section><div><pre><code class="language-julia hljs">fusion_source!(dd::IMAS.dd; DD_fusion::Bool=false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L33-L35">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.collisional_exchange_source!"><a class="docstring-binding" href="#IMAS.collisional_exchange_source!"><code>IMAS.collisional_exchange_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">collisional_exchange_source!(dd::IMAS.dd)</code></pre><p>Calculates collisional exchange source and adds it to <code>dd.core_sources</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L43-L47">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ohmic_source!"><a class="docstring-binding" href="#IMAS.ohmic_source!"><code>IMAS.ohmic_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ohmic_source!(dd::IMAS.dd)</code></pre><p>Calculates the ohmic source from data in <code>dd.core_profiles</code> and adds it to <code>dd.core_sources</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L67-L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.bootstrap_source!"><a class="docstring-binding" href="#IMAS.bootstrap_source!"><code>IMAS.bootstrap_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">bootstrap_source!(dd::IMAS.dd)</code></pre><p>Calculates the bootsrap current from profiles in <code>dd.core_profiles</code> and adds it both as source in <code>dd.core_sources</code> and <code>cp1d.j_bootstrap</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L96-L101">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.radiation_source!"><a class="docstring-binding" href="#IMAS.radiation_source!"><code>IMAS.radiation_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">radiation_source!(dd::IMAS.dd)</code></pre><p>Calculates the total radiation by calling:</p><ul><li>bremsstrahlung_source!()</li><li>line<em>radiation</em>source!()</li><li>synchrotron_source!()</li></ul><p>NOTE: if found, it removes total :radiation source to avoid double counting radiation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L116-L126">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sources!"><a class="docstring-binding" href="#IMAS.sources!"><code>IMAS.sources!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sources!(dd::IMAS.dd; bootstrap::Bool=true, DD_fusion::Bool=false)</code></pre><p>Calculates intrisic sources and sinks, and adds them to <code>dd.core_sources</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L145-L149">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.time_derivative_source!"><a class="docstring-binding" href="#IMAS.time_derivative_source!"><code>IMAS.time_derivative_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">time_derivative_source!(dd::IMAS.dd, cp1d_old::IMAS.core_profiles__profiles_1d, Δt::Float64; zero_out::Bool)</code></pre><p>Calculates time dependent sources and sinks, and adds them to <code>dd.core_sources</code></p><p>These are the ∂/∂t term in the transport equations</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L173-L179">source</a></section><section><div><pre><code class="language-julia hljs">time_derivative_source!(dd::IMAS.dd; zero_out::Bool=false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L225-L227">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.total_mass_density"><a class="docstring-binding" href="#IMAS.total_mass_density"><code>IMAS.total_mass_density</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_mass_density(cp1d::IMAS.core_profiles__profiles_1d)</code></pre><p>Finds the total mass density [kg/m^-3]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L243-L247">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.total_power_inside"><a class="docstring-binding" href="#IMAS.total_power_inside"><code>IMAS.total_power_inside</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_power_inside(
    core_sources::IMAS.core_sources,
    cp1d::IMAS.core_profiles__profiles_1d;
    time0::Float64=global_time(cp1d),
    include_radiation::Bool=true,
    include_time_derivative::Bool=true
)</code></pre><p>Returns total power inside of the separatrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L266-L276">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.total_power_source"><a class="docstring-binding" href="#IMAS.total_power_source"><code>IMAS.total_power_source</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_power_source(source::IMAS.core_sources__source___profiles_1d)</code></pre><p>Returns the total power (electron + ion) for a single source</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L302-L306">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.total_power_time"><a class="docstring-binding" href="#IMAS.total_power_time"><code>IMAS.total_power_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_power_time(core_sources::IMAS.core_sources, include_indexes::Vector{&lt;:Integer})</code></pre><p>Returns tuple of vectors with the total thermal power and time_array for given set of sources selected by identifier.index</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L314-L318">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.retain_source"><a class="docstring-binding" href="#IMAS.retain_source"><code>IMAS.retain_source</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">retain_source(source::IMAS.core_sources__source, all_indexes::Vector{Int}, include_indexes::Vector{Int}, exclude_indexes::Vector{Int})</code></pre><p>Function that decides whether a source should be kept or ignored when totaling sources</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L335-L339">source</a></section></details></article><div class="admonition is-warning" id="Missing-docstring.-da4b6106b673a175"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-da4b6106b673a175" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>IMAS.retain_source</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="IMAS.total_radiation_sources"><a class="docstring-binding" href="#IMAS.total_radiation_sources"><code>IMAS.total_radiation_sources</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_radiation_sources(dd::IMAS.dd; time0::Float64=dd.global_time, kw...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L555-L557">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sawteeth_source!"><a class="docstring-binding" href="#IMAS.sawteeth_source!"><code>IMAS.sawteeth_source!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sawteeth_source!(dd::IMAS.dd; qmin_desired::Float64=1.0)</code></pre><p>Model sawteeth by flattening all sources where abs(q) drops below qmin_desired</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L565-L569">source</a></section><section><div><pre><code class="language-julia hljs">sawteeth_source!(dd::IMAS.dd{T}, rho0::T) where {T&lt;:Real}</code></pre><p>Model sawteeth by flattening all sources within the inversion radius rho0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L592-L596">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.new_source"><a class="docstring-binding" href="#IMAS.new_source"><code>IMAS.new_source</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">new_source(
    source::IMAS.core_sources__source,
    index::Int,
    name::String,
    rho::Union{AbstractVector,AbstractRange},
    volume::Union{AbstractVector,AbstractRange},
    area::Union{AbstractVector,AbstractRange};
    electrons_energy::Union{AbstractVector,Missing}=missing,
    electrons_power_inside::Union{AbstractVector,Missing}=missing,
    total_ion_energy::Union{AbstractVector,Missing}=missing,
    total_ion_power_inside::Union{AbstractVector,Missing}=missing,
    electrons_particles::Union{AbstractVector,Missing}=missing,
    electrons_particles_inside::Union{AbstractVector,Missing}=missing,
    j_parallel::Union{AbstractVector,Missing}=missing,
    current_parallel_inside::Union{AbstractVector,Missing}=missing,
    momentum_tor::Union{AbstractVector,Missing}=missing,
    torque_tor_inside::Union{AbstractVector,Missing}=missing
)</code></pre><p>Populates the IMAS.core_sources__source with given heating, particle, current, momentun profiles</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L688-L709">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.total_power"><a class="docstring-binding" href="#IMAS.total_power"><code>IMAS.total_power</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_power(
    ps::Union{IMAS.pulse_schedule,IMAS.pulse_schedule__ec,IMAS.pulse_schedule__ic,IMAS.pulse_schedule__lh,IMAS.pulse_schedule__nbi},
    times::AbstractVector{Float64};
    time_smooth::Float64)</code></pre><p>Total injected power interpolated on a given time basis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/sources.jl#L815-L822">source</a></section></details></article><h2 id="Physics-technology"><a class="docs-heading-anchor" href="#Physics-technology">Physics technology</a><a id="Physics-technology-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-technology" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.coil_technology"><a class="docstring-binding" href="#IMAS.coil_technology"><code>IMAS.coil_technology</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">coil_technology(technology::Symbol, coil_type::Symbol)</code></pre><p>Return coil parameters from technology and coil type [:oh, :tf, :pf_active]&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/technology.jl#L38-L42">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.fraction_conductor"><a class="docstring-binding" href="#IMAS.fraction_conductor"><code>IMAS.fraction_conductor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fraction_conductor(coil_tech::Union{IMAS.build__pf_active__technology,IMAS.build__oh__technology,IMAS.build__tf__technology})</code></pre><p>returns the fraction of (super)conductor in a coil technology</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/technology.jl#L109-L113">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.GAMBL_blanket"><a class="docstring-binding" href="#IMAS.GAMBL_blanket"><code>IMAS.GAMBL_blanket</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">GAMBL_blanket(bm::IMAS.blanket__module)</code></pre><p>Define layers for the <code>dd.blanket.module</code> for a GAMBL type blanket technology</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/technology.jl#L127-L131">source</a></section></details></article><h2 id="Physics-tf"><a class="docs-heading-anchor" href="#Physics-tf">Physics tf</a><a id="Physics-tf-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-tf" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.tf_ripple"><a class="docstring-binding" href="#IMAS.tf_ripple"><code>IMAS.tf_ripple</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">tf_ripple(r, R_tf::Real, N_tf::Integer)</code></pre><p>Evaluate fraction of toroidal magnetic field ripple at <code>r</code> [m] generated from <code>N_tf</code> toroidal field coils with outer leg at <code>R_tf</code> [m]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/tf.jl#L3-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.R_tf_ripple"><a class="docstring-binding" href="#IMAS.R_tf_ripple"><code>IMAS.R_tf_ripple</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">R_tf_ripple(r, ripple::Real, N_tf::Integer)</code></pre><p>Evaluate location of toroidal field coils outer leg <code>R_tf</code><code>[m] at which</code>N_tf<code>toroidal field coils generate a given fraction of toroidal magnetic field ripple at</code>r` [m]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/tf.jl#L17-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.top_view_outline"><a class="docstring-binding" href="#IMAS.top_view_outline"><code>IMAS.top_view_outline</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">top_view_outline(tf::IMAS.build__tf, n::Int=1; cutouts::Bool=false)</code></pre><p>returns x,y outline (top view) of the n&#39;th TF coil</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/tf.jl#L29-L33">source</a></section></details></article><h2 id="Physics-thermal-loads"><a class="docs-heading-anchor" href="#Physics-thermal-loads">Physics thermal loads</a><a id="Physics-thermal-loads-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-thermal-loads" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.particle_heat_flux"><a class="docstring-binding" href="#IMAS.particle_heat_flux"><code>IMAS.particle_heat_flux</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">particle_heat_flux(
    SOL::OrderedCollections.OrderedDict{Symbol,Vector{OpenFieldLine}},
    rmesh::AbstractVector{&lt;:Real},
    zmesh::AbstractVector{&lt;:Real},
    r::Vector{&lt;:Real},
    q::Vector{&lt;:Real})</code></pre><p>Computes the heat flux on the wall due to the influx of charged particles using the Scrape Off-Layer, the mesh, and an hypothesis of the decay of the parallel heat flux at the OMP.</p><p>Assumption: Points at the extrema of OpenFieldLines in SOL are in the mesh (see mesher<em>heat</em>flux).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/thermal_loads.jl#L22-L34">source</a></section></details></article><h2 id="Physics-transport"><a class="docs-heading-anchor" href="#Physics-transport">Physics transport</a><a id="Physics-transport-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-transport" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.profile_from_z_transport"><a class="docstring-binding" href="#IMAS.profile_from_z_transport"><code>IMAS.profile_from_z_transport</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">profile_from_z_transport(
    profile_old::AbstractVector{&lt;:Real},
    rho::AbstractVector{&lt;:Real},
    transport_grid::AbstractVector{&lt;:Real},
    z_transport_grid::AbstractVector{&lt;:Real},
    rho_ped::Real=0.0)</code></pre><p>Updates profile<em>old with the scale lengths given by z</em>transport_grid</p><p>If <code>rho_ped &gt; transport_grid[end]</code> then scale-length is linearly interpolated between <code>transport_grid[end]</code> and <code>rho_ped</code></p><p>if <code>rho_ped &lt; transport_grid[end]</code> then scale-length then boundary condition is at <code>transport_grid[end]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/transport.jl#L3-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.profile_from_rotation_shear_transport"><a class="docstring-binding" href="#IMAS.profile_from_rotation_shear_transport"><code>IMAS.profile_from_rotation_shear_transport</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">profile_from_rotation_shear_transport(
    profile_old::AbstractVector{&lt;:Real},
    rho::AbstractVector{&lt;:Real},
    transport_grid::AbstractVector{&lt;:Real},
    rotation_shear_transport_grid::AbstractVector{&lt;:Real},
    rho_ped::Real=0.0)</code></pre><p>Updates rotation profile using the rotation shear given by rotation<em>shear</em>transport_grid</p><p>We integrate dω/dr to get ω(r).</p><p>If <code>rho_ped &gt; transport_grid[end]</code> then rotation shear is linearly interpolated between <code>transport_grid[end]</code> and <code>rho_ped</code></p><p>If <code>rho_ped &lt; transport_grid[end]</code> then boundary condition is at <code>transport_grid[end]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/transport.jl#L48-L63">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.total_fluxes"><a class="docstring-binding" href="#IMAS.total_fluxes"><code>IMAS.total_fluxes</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_fluxes(
    core_transport::IMAS.core_transport{T},
    cp1d::IMAS.core_profiles__profiles_1d,
    rho_total_fluxes::AbstractVector{&lt;:Real};
    time0::Float64) where {T&lt;:Real}</code></pre><p>Sums up all the fluxes and returns it as a core_transport.model IDS</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/transport.jl#L109-L117">source</a></section><section><div><pre><code class="language-julia hljs">total_fluxes(dd::IMAS.dd, rho_total_fluxes::AbstractVector{&lt;:Real}=dd.core_profiles.profiles_1d[].grid.rho_tor_norm; time0::Float64=dd.global_time)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/physics/transport.jl#L218-L220">source</a></section></details></article><h2 id="Plot"><a class="docs-heading-anchor" href="#Plot">Plot</a><a id="Plot-1"></a><a class="docs-heading-anchor-permalink" href="#Plot" title="Permalink"></a></h2><h2 id="Real"><a class="docs-heading-anchor" href="#Real">Real</a><a id="Real-1"></a><a class="docs-heading-anchor-permalink" href="#Real" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Base.fill!"><a class="docstring-binding" href="#Base.fill!"><code>Base.fill!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fill!(ids_new::IDS{&lt;:T1}, ids::IDS{&lt;:T2}, field::Symbol) where {T1&lt;:Measurement{&lt;:Real},T2&lt;:Real}</code></pre><p>Function used to map fields in <code>IDS{T}</code> to <code>IDS{Measurement{T}}</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/real.jl#L33-L37">source</a></section><section><div><pre><code class="language-julia hljs">fill!(ids_new::IDS{&lt;:T1}, ids::IDS{&lt;:T2}, field::Symbol) where {T1&lt;:Real,T2&lt;:Measurement{&lt;:Real}}</code></pre><p>Function used to map fields in <code>IDS{Measurement{T}}</code> to <code>IDS{T}</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/real.jl#L59-L63">source</a></section><section><div><pre><code class="language-julia hljs">fill!(@nospecialize(ids_new::IDS{&lt;:T1}), @nospecialize(ids::IDS{&lt;:T2}), field::Symbol) where {T1&lt;:Float64,T2&lt;:ForwardDiff.Dual{Float64,Float64,0}}</code></pre><p>Function used to map fields in <code>IDS{Dual{T,T,0}}</code> to <code>IDS{T}</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/real.jl#L99-L103">source</a></section></details></article><h2 id="Signal"><a class="docs-heading-anchor" href="#Signal">Signal</a><a id="Signal-1"></a><a class="docs-heading-anchor-permalink" href="#Signal" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.heaviside"><a class="docstring-binding" href="#IMAS.heaviside"><code>IMAS.heaviside</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">heaviside(t::Float64)</code></pre><p>Heaviside step triggered at t=0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L5-L9">source</a></section><section><div><pre><code class="language-julia hljs">heaviside(t::Float64, t_start::Float64)</code></pre><p>Heaviside step triggered at t=t_start</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L14-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.pulse"><a class="docstring-binding" href="#IMAS.pulse"><code>IMAS.pulse</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pulse(t::Float64)</code></pre><p>Unitary pulse with width of 1, starting at t=0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L26-L30">source</a></section><section><div><pre><code class="language-julia hljs">pulse(t::Float64, t_start::Float64, Δt::Float64)</code></pre><p>Unitary pulse with given width Δt, starting at t=t_start</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L37-L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.ramp"><a class="docstring-binding" href="#IMAS.ramp"><code>IMAS.ramp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ramp(t::Float64)</code></pre><p>Unitary ramp from t=0 to t=1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L49-L53">source</a></section><section><div><pre><code class="language-julia hljs">ramp(t::Float64, ramp_fraction::Float64)</code></pre><p>Unitary ramp</p><p>The <code>ramp_fraction</code> defines the fraction of ramp with respect to 1.0 and must be between [0.0,1.0]</p><p>NOTE: This function is designed as is to be able to switch between <code>ramp(t, ramp_fraction)</code> and <code>trap(t, ramp_fraction)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L60-L68">source</a></section><section><div><pre><code class="language-julia hljs">ramp(t::Float64, t_start::Float64, Δt::Float64)</code></pre><p>Unitary ramp of duration Δt, starting at t=t_start</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L79-L83">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.trap"><a class="docstring-binding" href="#IMAS.trap"><code>IMAS.trap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">trap(t::Float64, ramp_fraction::Float64)</code></pre><p>Unitary trapezoid</p><p>The <code>ramp_fraction</code> defines the fraction of ramp with respect to flattop and must be between [0.0,0.5]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L91-L97">source</a></section><section><div><pre><code class="language-julia hljs">trap(t::Float64, t_start::Float64, Δt::Float64, ramp_fraction::Float64)</code></pre><p>Unitary trapezoid of duration Δt, starting at t=t_start</p><p>The <code>ramp_fraction</code> defines the fraction of ramp with respect to flattop and must be between [0.0,0.5]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L110-L116">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.gaus"><a class="docstring-binding" href="#IMAS.gaus"><code>IMAS.gaus</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">gaus(t::Float64, order::Float64=1.0)</code></pre><p>Unitary gaussian</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L124-L128">source</a></section><section><div><pre><code class="language-julia hljs">gaus(t::Float64, t_start::Float64, Δt::Float64, order::Float64=1.0)</code></pre><p>Unitary gaussian centered at t_start and with standard deviation Δt</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L133-L137">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.beta"><a class="docstring-binding" href="#IMAS.beta"><code>IMAS.beta</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">beta(t::Float64, mode::Float64)</code></pre><p>Unitary beta distribution</p><p>The <code>mode</code> [-1.0, 1.0] defines how skewed the distribution is</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L145-L151">source</a></section><section><div><pre><code class="language-julia hljs">beta(t::Float64, t_start::Float64, Δt::Float64, mode::Float64)</code></pre><p>Unitary beta distribution of duration Δt, starting at t=t_start</p><p>The <code>mode</code> [-1.0, 1.0] defines how skewed the distribution is</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L185-L191">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.sequence"><a class="docstring-binding" href="#IMAS.sequence"><code>IMAS.sequence</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sequence(t::Float64, t_y_sequence::Vector{Tuple{Float64,Float64}}; scheme::Symbol=:linear)</code></pre><p>returns interpolated data given a sequence (tuple) of time/value points</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L199-L203">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.moving_average"><a class="docstring-binding" href="#IMAS.moving_average"><code>IMAS.moving_average</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">moving_average(data::Vector{&lt;:Real}, window_size::Int)</code></pre><p>Calculate the moving average of a data vector using a specified window size. The window size is always rounded up to the closest odd number to maintain symmetry around each data point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L213-L218">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.highpassfilter"><a class="docstring-binding" href="#IMAS.highpassfilter"><code>IMAS.highpassfilter</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">highpassfilter(signals, fs, cutoff, order=4)</code></pre><p>Apply butterworth high pass filter of given order to signals sampled with frequency <code>fs</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L284-L288">source</a></section></details></article><article><details class="docstring" open="true"><summary id="IMAS.lowpassfilter"><a class="docstring-binding" href="#IMAS.lowpassfilter"><code>IMAS.lowpassfilter</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">lowpassfilter(signals, fs, cutoff, order=4)</code></pre><p>Apply butterworth low pass filter of given order to signals sampled with frequency <code>fs</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/signal.jl#L299-L303">source</a></section></details></article><h2 id="get-from"><a class="docs-heading-anchor" href="#get-from">get from</a><a id="get-from-1"></a><a class="docs-heading-anchor-permalink" href="#get-from" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="IMAS.get_from"><a class="docstring-binding" href="#IMAS.get_from"><code>IMAS.get_from</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_from(dd::IMAS.dd, what::Symbol, from_where::Symbol; time0::Float64=dd.global_time)</code></pre><p>IMAS stores the same physical quantities in different IDSs, and <code>get_from()</code> abstracts away the details of which IDS to access, depending on the requested quantity (<code>what</code>) and the specified source (<code>from_where</code>). This is generally useful when coupling different codes/modules/actors.</p><p>Supported quantities for <code>what</code>:</p><ul><li><code>:ip</code>          - Plasma current [A]<ul><li>Possible sources (<code>from_where</code>): <code>:equilibrium</code>, <code>:core_profiles</code>, <code>:pulse_schedule</code></li></ul></li><li><code>:vacuum_r0_b0</code>- Vacuum magnetic field parameters (major radius <code>r0</code> [m], toroidal field <code>b0</code> [T])<ul><li>Possible sources (<code>from_where</code>): <code>:equilibrium</code>, <code>:pulse_schedule</code></li></ul></li><li><code>:vloop</code>       - Loop voltage [V]<ul><li>Possible sources (<code>from_where</code>): <code>:equilibrium</code>, <code>:core_profiles</code>, <code>:pulse_schedule</code>, <code>:controllers__ip</code></li></ul></li><li><code>:βn</code>          - Normalized beta [-]<ul><li>Possible sources (<code>from_where</code>): <code>:equilibrium</code>, <code>:core_profiles</code></li></ul></li><li><code>:ne_ped</code>      - Electron density at the pedestal [m^-3]<ul><li>Possible sources (<code>from_where</code>): <code>:core_profiles</code>, <code>:summary</code>, <code>:pulse_schedule</code></li></ul></li><li><code>:zeff_ped</code>    - Effective charge at the pedestal [-]<ul><li>Possible sources (<code>from_where</code>): <code>:core_profiles</code>, <code>:summary</code>, <code>:pulse_schedule</code></li></ul></li></ul><p><code>time0</code> defines the time point at which to retrieve the value, default is <code>dd.global_time</code>.</p><p>Returns the requested physical quantity from the specified location in the IMAS data structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ProjectTorreyPines/IMAS.jl/blob/c42fbdc19d28d357a53fa9565cdee0a695f08356/src/get_from.jl#L124-L148">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« IMAS.jl</a><a class="docs-footer-nextpage" href="../expressions/">Expressions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 17 December 2025 02:35">Wednesday 17 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
